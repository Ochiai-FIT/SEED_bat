REM [026][069_LOAD]
@ECHO OFF

REM ログフォルダ作成
IF NOT EXIST %~DP0..\logs MKDIR %~DP0..\logs

REM コマンドフォルダ作成
IF NOT EXIST %~DP0..\cmd MKDIR %~DP0..\cmd

REM ログファイルの情報
SET OUTFILE=%~DP0../logs/setup.log
SET OUTTIME=%~DP0../logs/time.log

REM ベースフォルダ
SET BASEDIR=%~DP0..

REM 更新対象の情報
SET INFOSCRIPT=%~DP0..\cmd\%~N0.DB2


SET INFILENAME=
SET MSG=%DATE% %TIME% 催しコード INATK.TOKMOYCD BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKMOYCD
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(SHUNO,0)||','||COALESCE(MOYKN,0)||','||COALESCE(MOYAN,0)||','||COALESCE(NENMATKBN,0)||','||COALESCE(HBSTDT,0)||','||COALESCE(HBEDDT,0)||','||COALESCE(NNSTDT,0)||','||COALESCE(NNEDDT,0)||','||COALESCE(NNSTDT_TGF,0)||','||COALESCE(NNEDDT_TGF,0)||','||COALESCE(PLUSDDT,0)||','||COALESCE(PLUSFLG,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKMOYCD;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催しコード INATK.TOKMOYCD DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKMOYCD T1 WHERE EXISTS (SELECT 1 FROM (SELECT PTNCD, CASE WHEN PTNCD BETWEEN 5 AND 7 THEN CAST(DATE_FORMAT(DATE_FORMAT(SHORIDT, '%%Y%%m%%d') - INTERVAL 1 DAY - INTERVAL X.MWDSU MONTH, '%%Y%%m%%d') AS SIGNED) ELSE CAST(DATE_FORMAT(DATE_FORMAT(SHORIDT, '%%Y%%m%%d') - INTERVAL 1 DAY - INTERVAL X.MWDSU DAY, '%%Y%%m%%d') AS SIGNED) END AS SHORIDT FROM INAAD.SYSSHORIDT, (SELECT PTNCD, MWDSU FROM INAAD.SYSTOKDELCTL WHERE P_TABLENM = 'TOKMOYCD') X) T2 WHERE T1.HBEDDT <= T2.SHORIDT AND T1.MOYSKBN=T2.PTNCD AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% ちらしのみ部門 INATK.TOKCHIRASBMN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKCHIRASBMN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKCHIRASBMN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% ちらしのみ部門 INATK.TOKCHIRASBMN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKCHIRASBMN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し週 INATK.TOKMOYSYU BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKMOYSYU
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(SHUNO, '') || ',' || COALESCE(TSHUFLG, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKMOYSYU;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し週 INATK.TOKMOYSYU DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKMOYSYU T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.SHUNO=T1.SHUNO AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% 臨時ランクマスタ INATK.TOKRANKEX BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKRANKEX
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(BMNCD, '') || ',' || COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(RANKNO, '') || ',' || COALESCE(RANKKN, '') || ',' || COALESCE(TENRANK_ARR, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKRANKEX;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 臨時ランクマスタ INATK.TOKRANKEX DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.TOKRANKEX T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% 臨時数量パターン INATK.TOKSRPTNEX BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSRPTNEX
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(BMNCD, '') || ',' || COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(SRYPTNNO, '') || ',' || COALESCE(SRYPTNKN, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKSRPTNEX;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 臨時数量パターン INATK.TOKSRPTNEX DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKSRPTNEX T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR



SET MSG=%DATE% %TIME% 臨時数量ランク INATK.TOKSRYRANKEX BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSRYRANKEX
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(BMNCD, '') || ',' || COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(SRYPTNNO, '') || ',' || COALESCE(TENRANK, '') || ',' || COALESCE(SURYO, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKSRYRANKEX;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 臨時数量ランク INATK.TOKSRYRANKEX DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKSRYRANKEX T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% BM催し送信 INATK.TOKBM BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKBM
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(BMNNO,0)||','||COALESCE(BMNMAN,0)||','||COALESCE(BMNMKN,0)||','||COALESCE(HBSTDT,0)||','||COALESCE(HBEDDT,0)||','||COALESCE(BMTYP,0)||','||COALESCE(BAIKAAM,0)||','||COALESCE(BD_KOSU1,0)||','||COALESCE(BD_BAIKAAN1,0)||','||COALESCE(BD_KOSU2,0)||','||COALESCE(BD_BAIKAAN2,0)||','||COALESCE(BMNCD_RANK,0)||','||COALESCE(RANKNO_ADD,0)||','||COALESCE(RANKNO_DEL,0)||','||COALESCE(TENATSUK_ARR,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKBM;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% BM催し送信 INATK.TOKBM DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKBM T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% BM催し送信_対象除外店 INATK.TOKBM_TJTEN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKBM_TJTEN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(BMNNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(TJFLG, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKBM_TJTEN;" >%OUTFILENAME% 2>>%OUTFILE%

SET MSG=%DATE% %TIME% BM催し送信_対象除外店 INATK.TOKBM_TJTEN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKBM_TJTEN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% BM催し送信_商品 INATK.TOKBM_SHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKBM_SHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e"SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(BMNNO, '') || ',' || COALESCE(KANRINO, '') || ',' || COALESCE(SHNCD, '') || ',' || COALESCE(GENKAAM, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKBM_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% BM催し送信_商品 INATK.TOKBM_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKBM_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 生活応援_部門 INATK.TOKSO_BMN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSO_BMN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKSO_BMN;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 生活応援_部門 INATK.TOKSO_BMN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.TOKSO_BMN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 生活応援_商品 INATK.TOKSO_SHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSO_SHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(BMNCD,0)||','||COALESCE(KANRINO,0)||','||COALESCE(RPAD(SHNCD,14,' '),0)||','||COALESCE(MAKERKN,0)||','||COALESCE(SHNKN,0)||','||COALESCE(KIKKN,0)||','||COALESCE(IRISU,0)||','||COALESCE(MINSU,0)||','||COALESCE(CONCAT('+',RPAD(GENKAAM,10,'0')),0)||','||COALESCE(A_BAIKAAM,0)||','||COALESCE(B_BAIKAAM,0)||','||COALESCE(C_BAIKAAM,0)||','||COALESCE(A_RANKNO,0)||','||COALESCE(B_RANKNO,0)||','||COALESCE(C_RANKNO,0)||','||COALESCE(POPCD,0)||','||COALESCE(POPSZ,0)||','||COALESCE(POPSU,0)||','||COALESCE(TENATSUK_ARR,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKSO_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 生活応援_商品 INATK.TOKSO_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKSO_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前打出し商品 INATK.TOKJU_SHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKJU_SHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(KANRINO,0)||','||COALESCE(RPAD(SHNCD,14,' '),0)||','||COALESCE(SHNKBN,0)||','||COALESCE(TSEIKBN,0)||','||COALESCE(JUKBN,0)||','||COALESCE(BDENKBN,0)||','||COALESCE(WAPPNKBN,0)||','||COALESCE(IRISU,0)||','||COALESCE(CONCAT('+',LPAD(GENKAAM,11,'0')),0)||','||COALESCE(BAIKAAM,0)||','||COALESCE(HTDT,0)||','||COALESCE(NNDT,0)||','||COALESCE(JUTENKAIKBN,0)||','||COALESCE(RANKNO_ADD,0)||','||COALESCE(HTSU,0)||','||COALESCE(SURYOPTN,0)||','||COALESCE(TENHTSU_ARR,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKJU_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前打出し商品 INATK.TOKJU_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKJU_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1


SET MSG=%DATE% %TIME% 店舗アンケート付き送付け_催し INATK.TOKQJU_MOY BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKQJU_MOY
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(QASMDT, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKQJU_MOY;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 店舗アンケート付き送付け_催し INATK.TOKQJU_MOY DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKQJU_MOY T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 店舗アンケート付き送付け_商品 INATK.TOKQJU_SHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKQJU_SHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(KANRINO,0)||','||COALESCE(RPAD(SHNCD,14,' '),0)||','||COALESCE(SHNKBN,0)||','||COALESCE(TSEIKBN,0)||','||COALESCE(JUKBN,0)||','||COALESCE(BDENKBN,0)||','||COALESCE(WAPPNKBN,0)||','||COALESCE(IRISU,0)||','||COALESCE(CONCAT('+',LPAD(GENKAAM,10,'0')),0)||','||COALESCE(BAIKAAM,0)||','||COALESCE(HTDT,0)||','||COALESCE(NNDT,0)||','||COALESCE(JUTENKAIKBN,0)||','||COALESCE(RANKNO_ADD,0)||','||COALESCE(HTSU,0)||','||COALESCE(SURYOPTN,0)||','||COALESCE(TENHTSU_ARR,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKQJU_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 店舗アンケート付き送付け_商品 INATK.TOKQJU_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKQJU_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1


SET MSG=%DATE% %TIME% 全店特売（アンケート有）_基本 INATK.TOKTG_KHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_KHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(HBOKUREFLG,0)||','||COALESCE(GTSIMEDT,0)||','||COALESCE(GTSIMEFLG,0)||','||COALESCE(LSIMEDT,0)||','||COALESCE(QAYYYYMM,0)||','||COALESCE(QAENO,0)||','||COALESCE(QACREDT,0)||','||COALESCE(QARCREDT,0)||','||COALESCE(JLSTCREFLG,0)||','||COALESCE(HNCTLFLG,0)||','||COALESCE(TPNG1FLG,0)||','||COALESCE(TPNG2FLG,0)||','||COALESCE(TPNG3FLG,0)||','||COALESCE(SIMEFLG1_LD,0)||','||COALESCE(SIMEFLG2_LD,0)||','||COALESCE(SIMEFLG_MB,0)||','||COALESCE(QADEVSTDT,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKTG_KHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売（アンケート有）_基本 INATK.TOKTG_KHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.TOKTG_KHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート有)_店グループ INATK.TOKTG_TENGP BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_TENGP
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(TENGPCD,0)||','||COALESCE(TENGPKN,0)||','||COALESCE(KYOSEIFLG,0)||','||COALESCE(QASYUKBN,0)||','||COALESCE(QACREDT_K,0)||','||COALESCE(QARCREDT_K,0)||','||COALESCE(QARCREDT_K,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKTG_TENGP;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_店グループ INATK.TOKTG_TENGP DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.TOKTG_TENGP T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート有)_店舗 INATK.TOKTG_TEN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_TEN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(KYOSEIFLG, '') || ',' || COALESCE(TENGPCD, '') || ',' || COALESCE(LDTENKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTG_TEN;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_店舗 INATK.TOKTG_TEN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_TEN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート有)_部門 INATK.TOKTG_BMN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_BMN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTG_BMN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_部門 INATK.TOKTG_BMN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_BMN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート有)_商品 INATK.TOKTG_SHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_SHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(BMNCD,0)||','||COALESCE(KANRINO,0)||','||COALESCE(KANRIENO,0)||','||COALESCE(ADDSHUKBN,0)||','||COALESCE(HBSLIDEFLG,0)||','||COALESCE(NHSLIDEFLG,0)||','||COALESCE(BYCD,0)||','||COALESCE(LPAD(SHNCD,14,' '),0)||','||COALESCE(PARNO,0)||','||COALESCE(CHLDNO,0)||','||COALESCE(HIGAWRFLG,0)||','||COALESCE(HBSTDT,0)||','||COALESCE(HBEDDT,0)||','||COALESCE(NNSTDT,0)||','||COALESCE(NNEDDT,0)||','||COALESCE(CHIRASFLG,0)||','||COALESCE(RANKNO_ADD,0)||','||COALESCE(HBYOTEISU,0)||','||COALESCE(CONCAT('+',LPAD(GENKAAM_MAE,10,'0')),0)||','||COALESCE(CONCAT('+',LPAD(GENKAAM_ATO,10,'0')),0)||','||COALESCE(A_BAIKAAM,0)||','||COALESCE(B_BAIKAAM,0)||','||COALESCE(C_BAIKAAM,0)||','||COALESCE(IRISU,0)||','||COALESCE(HTGENBAIKAFLG,0)||','||COALESCE(A_WRITUKBN,0)||','||COALESCE(B_WRITUKBN,0)||','||COALESCE(C_WRITUKBN,0)||','||COALESCE(TKANPLUKBN,0)||','||COALESCE(A_GENKAAM_1KG,0)||','||COALESCE(B_GENKAAM_1KG,0)||','||COALESCE(C_GENKAAM_1KG,0)||','||COALESCE(GENKAAM_PACK,0)||','||COALESCE(A_BAIKAAM_PACK,0)||','||COALESCE(B_BAIKAAM_PACK,0)||','||COALESCE(C_BAIKAAM_PACK,0)||','||COALESCE(A_BAIKAAM_100G,0)||','||COALESCE(B_BAIKAAM_100G,0)||','||COALESCE(C_BAIKAAM_100G,0)||','||COALESCE(GENKAAM_1KG,0)||','||COALESCE(PLUSNDFLG,0)||','||COALESCE(TENKAIKBN,0)||','||COALESCE(JSKPTNSYUKBN,0)||','||COALESCE(JSKPTNZNENMKBN,0)||','||COALESCE(JSKPTNZNENWKBN,0)||','||COALESCE(DAICD,0)||','||COALESCE(CHUCD,0)||','||COALESCE(SANCHIKN,0)||','||COALESCE(MAKERKN,0)||','||COALESCE(POPKN,0)||','||COALESCE(KIKKN,0)||','||COALESCE(SEGN_NINZU,0)||','||COALESCE(SEGN_GENTEI,0)||','||COALESCE(SEGN_1KOSU,0)||','||COALESCE(SEGN_1KOSUTNI,0)||','||COALESCE(YORIFLG,0)||','||COALESCE(BD1_TENSU,0)||','||COALESCE(BD2_TENSU,0)||','||COALESCE(KO_A_BAIKAAN,0)||','||COALESCE(BD1_A_BAIKAAN,0)||','||COALESCE(KO_B_BAIKAAN,0)||','||COALESCE(BD1_B_BAIKAAN,0)||','||COALESCE(BD2_B_BAIKAAN,0)||','||COALESCE(KO_C_BAIKAAN,0)||','||COALESCE(MEDAMAKBN,0)||','||COALESCE(POPCD,0)||','||COALESCE(POPSZ,0)||','||COALESCE(POPSU,0)||','||COALESCE(SHNSIZE,0)||','||COALESCE(SHNCOLOR,0)||','||COALESCE(COMMENT_HGW,0)||','||COALESCE(COMMENT_POP,0)||','||COALESCE(NAMANETUKBN,0)||','||COALESCE(KAITOFLG,0)||','||COALESCE(YOSHOKUFLG,0)||','||COALESCE(JUFLG,0)||','||COALESCE(JUHTDT,0)||','||COALESCE(COMMENT_TB,0)||','||COALESCE(CUTTENFLG,0)||','||COALESCE(BINKBN,0)||','||COALESCE(BDENKBN,0)||','||COALESCE(WAPPNKBN,0)||','||COALESCE(SHUDENFLG,0)||','||COALESCE(TENRANK_ARR,0)||','||COALESCE(GTSIMECHGKBN,0)||','||COALESCE(GTSIMEOKFLG,0)||','||COALESCE(JLSTCREDT,0)||','||COALESCE(JHTSUINDT,0)||','||COALESCE(WEEKHTDT,0)||','||COALESCE(MYOSHBSTDT,0)||','||COALESCE(MYOSHBEDDT,0)||','||COALESCE(MYOSNNSTDT,0)||','||COALESCE(MYOSNNEDDT,0)||','||COALESCE(UPDKBN,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0)||','||COALESCE(SHOBUNCD,0) FROM INATK.TOKTG_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_商品 INATK.TOKTG_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_対象除外店 INATK.TOKTG_TJTEN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_TJTEN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(BMNCD,0)||','||COALESCE(KANRINO,0)||','||COALESCE(KANRIENO,0)||','||COALESCE(TENCD,0)||','||COALESCE(TJFLG,0)||','||COALESCE(TENRANK,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKTG_TJTEN;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_対象除外店 INATK.TOKTG_TJTEN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_TJTEN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート有)_販売 INATK.TOKTG_HB BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_HB
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(BMNCD,0)||','||COALESCE(KANRINO,0)||','||COALESCE(KANRIENO,0)||','||COALESCE(TENATSUK_ARR,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKTG_HB;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_販売 INATK.TOKTG_HB DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_HB T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート有)_納入日 INATK.TOKTG_NNDT BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_NNDT
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(BMNCD,0)||','||COALESCE(KANRINO,0)||','||COALESCE(KANRIENO,0)||','||COALESCE(NNDT,0)||','||COALESCE(TENHTSU_ARR,0)||','||COALESCE(HTASU,0)||','||COALESCE(PTNNO,0)||','||COALESCE(TSEIKBN,0)||','||COALESCE(TPSU,0)||','||COALESCE(TENKAISU,0)||','||COALESCE(ZJSKFLG,0)||','||COALESCE(WEEKHTDT,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0)||','||COALESCE(BAT_CTLFLG01,0) FROM INATK.TOKTG_NNDT;" >%OUTFILENAME% 2>>%OUTFILE%

SET MSG=%DATE% %TIME% 全店特売(アンケート有)_納入日 INATK.TOKTG_NNDT DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_NNDT T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% アンケート結果_店グループ INATK.TOKTG_QAGP BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_QAGP
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(TENGPCD,0)||','||COALESCE(KYOSEIFLG,0)||','||COALESCE(QASYUKBN,0)||','||COALESCE(LDSYFLG,0)||','||COALESCE(URIASELKBN,0)||','||COALESCE(SCHANSFLG,0)||','||COALESCE(ITMANSFLG,0)||','||COALESCE(CSVSEQNO,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKTG_QAGP;" >%OUTFILENAME% 2>>%OUTFILE
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% アンケート結果_店グループ INATK.TOKTG_QAGP DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_QAGP T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% アンケート結果_店舗 INATK.TOKTG_QATEN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_QATEN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,0)||','||COALESCE(MOYSSTDT,0)||','||COALESCE(MOYSRBAN,0)||','||COALESCE(TENCD,0)||','||COALESCE(KYOSEIFLG,0)||','||COALESCE(TENGPCD,0)||','||COALESCE(LDTENKBN,0)||','||COALESCE(MBSYFLG,0)||','||COALESCE(HBSTRTFLG,0)||','||COALESCE(MBANSFLG,0)||','||COALESCE(CSVSEQNO,0)||','||COALESCE(SENDFLG,0)||','||COALESCE(OPERATOR,0)||','||COALESCE(ADDDT,0)||','||COALESCE(UPDDT,0) FROM INATK.TOKTG_QATEN;" >%OUTFILENAME% 2>>%OUTFILE
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% アンケート結果_店舗 INATK.TOKTG_QATEN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTG_QATEN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% アンケート結果_商品 INATK.TOKTG_QASHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTG_QASHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(TENGPCD, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(KANRINO, '') || ',' || COALESCE(KANRIENO, '') || ',' || COALESCE(URISELKBN, '') || ',' || COALESCE(ITMSELKBN, '') || ',' || COALESCE(URICHGAM1, '') || ',' || COALESCE(URICHGAM2, '') || ',' || COALESCE(URICHGAM3, '') || ',' || COALESCE(CSVSEQNO, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTG_QASHN;" >%OUTFILENAME% 2>>%OUTFILE
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% アンケート結果_商品 INATK.TOKTG_QASHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.TOKTG_QASHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート無)_部門 INATK.TOKSP_BMN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSP_BMN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(UPDKBN, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKSP_BMN;" >%OUTFILENAME% 2>>%OUTFILE%

SET MSG=%DATE% %TIME% 全店特売(アンケート無)_部門 INATK.TOKSP_BMN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKSP_BMN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート無)_商品 INATK.TOKSP_SHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSP_SHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMNCD,'')||','||COALESCE(KANRINO,'')||','||COALESCE(KANRIENO,'')||','||COALESCE(ADDSHUKBN,'')||','||COALESCE(BYCD,'')||','||COALESCE(SHNCD,'')||','||COALESCE(PARNO,'')||','||COALESCE(CHLDNO,'')||','||COALESCE(HIGAWRFLG,'')||','||COALESCE(HBSTDT,'')||','||COALESCE(HBEDDT,'')||','||COALESCE(NNSTDT,'')||','||COALESCE(NNEDDT,'')||','||COALESCE(CHIRASFLG,'')||','||COALESCE(RANKNO_ADD_A,'')||','||COALESCE(RANKNO_ADD_B,'')||','||COALESCE(RANKNO_ADD_C,'')||','||COALESCE(RANKNO_DEL,'')||','||COALESCE(HBYOTEISU,'')||','||COALESCE(GENKAAM_MAE,'')||','||COALESCE(GENKAAM_ATO,'')||','||COALESCE(A_BAIKAAM,'')||','||COALESCE(B_BAIKAAM,'')||','||COALESCE(C_BAIKAAM,'')||','||COALESCE(IRISU,'')||','||COALESCE(HTGENBAIKAFLG,'')||','||COALESCE(A_WRITUKBN,'')||','||COALESCE(B_WRITUKBN)||','||COALESCE(C_WRITUKBN,'')||','||COALESCE(TKANPLUKBN,'')||','||COALESCE(A_GENKAAM_1KG,'')||','||COALESCE(B_GENKAAM_1KG,'')||','||COALESCE(C_GENKAAM_1KG,'')||','||COALESCE(GENKAAM_PACK,'')||','||COALESCE(A_BAIKAAM_PACK,'')||','||COALESCE(B_BAIKAAM_PACK,'')||','||COALESCE(C_BAIKAAM_PACK,'')||','||COALESCE(A_BAIKAAM_100G,'')||','||COALESCE(B_BAIKAAM_100G,'')||','||COALESCE(C_BAIKAAM_100G,'')||','||COALESCE(GENKAAM_1KG,'')||','||COALESCE(PLUSNDFLG,'')||','||COALESCE(TENKAIKBN,'')||','||COALESCE(JSKPTNSYUKBN,'')||','||COALESCE(JSKPTNZNENMKBN,'')||','||COALESCE(JSKPTNZNENWKBN,'')||','||COALESCE(DAICD,'')||','||COALESCE(CHUCD,'')||','||COALESCE(SANCHIKN,'')||','||COALESCE(MAKERKN,'')||','||COALESCE(POPKN,'')||','||COALESCE(KIKKN,'')||','||COALESCE(SEGN_NINZU,'')||','||COALESCE(SEGN_GENTEI,'')||','||COALESCE(SEGN_1KOSU,'')||','||COALESCE(SEGN_1KOSUTNI,'')||','||COALESCE(YORIFLG,'')||','||COALESCE(BD1_TENSU,'')||','||COALESCE(BD2_TENSU,'')||','||COALESCE(KO_A_BAIKAAN,'')||','||COALESCE(BD1_A_BAIKAAN,'')||','||COALESCE(BD2_A_BAIKAAN,'')||','||COALESCE(KO_B_BAIKAAN,'')||','||COALESCE(BD1_B_BAIKAAN,'')||','||COALESCE(BD2_B_BAIKAAN,'')||','||COALESCE(KO_C_BAIKAAN,'')||','||COALESCE(BD1_C_BAIKAAN,'')||','||COALESCE(BD2_C_BAIKAAN,'')||','||COALESCE(MEDAMAKBN,'')||','||COALESCE(POPCD,'')||','||COALESCE(POPSZ,'')||','||COALESCE(POPSU,'')||','||COALESCE(SHNSIZE,'')||','||COALESCE(SHNCOLOR,'')||','||COALESCE(COMMENT_HGW,'')||','||COALESCE(COMMENT_POP,'')||','||COALESCE(NAMANETUKBN,'')||','||COALESCE(KAITOFLG,'')||','||COALESCE(YOSHOKUFLG,'')||','||COALESCE(JUFLG,'')||','||COALESCE(JUHTDT,'')||','||COALESCE(COMMENT_TB,'')||','||COALESCE(CUTTENFLG,'')||','||COALESCE(BINKBN,'')||','||COALESCE(BDENKBN,'')||','||COALESCE(WAPPNKBN,'')||','||COALESCE(SHUDENFLG,'')||','||COALESCE(TENRANK_ARR,'')||','||COALESCE(JLSTCREDT,'')||','||COALESCE(JHTSUINDT,'')||','||COALESCE(WEEKHTDT,'')||','||COALESCE(MYOSHBSTDT,'')||','||COALESCE(MYOSHBEDDT,'')||','||COALESCE(MYOSNNSTDT,'')||','||COALESCE(MYOSNNEDDT,'')||','||COALESCE(UPDKBN,'')||','||COALESCE(SENDFLG,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.TOKSP_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート無)_商品 INATK.TOKSP_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKSP_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート無)_対象除外店 INATK.TOKSP_TJTEN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSP_TJTEN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMNCD,'')||','||COALESCE(KANRINO,'')||','||COALESCE(KANRIENO,'')||','||COALESCE(TENCD,'')||','||COALESCE(TJFLG,'')||','||COALESCE(TENRANK,'')||','||COALESCE(SENDFLG,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.TOKSP_TJTEN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート無)_対象除外店 INATK.TOKSP_TJTEN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKSP_TJTEN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF NOT %ERRORLEVEL%==0 GOTO ERROR

SET MSG=%DATE% %TIME% 全店特売(アンケート無)_販売 INATK.TOKSP_HB BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSP_HB
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(KANRINO, '') || ',' || COALESCE(KANRIENO, '') || ',' || COALESCE(TENATSUK_ARR, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKSP_HB;" >%OUTFILENAME% 2>>%OUTFILE%
IF NOT %ERRORLEVEL%==0 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート無)_販売 INATK.TOKSP_HB DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKSP_HB T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 全店特売(アンケート無)_納入日 INATK.TOKSP_NNDT BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKSP_NNDT
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMNCD,'')||','||COALESCE(KANRINO,'')||','||COALESCE(KANRIENO,'')||','||COALESCE(NNDT,'')||','||COALESCE(TENHTSU_ARR,'')||','||COALESCE(HTASU,'')||','||COALESCE(PTNNO,'')||','||COALESCE(TSEIKBN,'')||','||COALESCE(TPSU,'')||','||COALESCE(TENKAISU,'')||','||COALESCE(ZJSKFLG,'')||','||COALESCE(WEEKHTDT,'')||','||COALESCE(SENDFLG,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'')||','||COALESCE(BAT_CTLFLG01,'') FROM INATK.TOKSP_NNDT;" >%OUTFILENAME% 2>>%OUTFILE%

SET MSG=%DATE% %TIME% 全店特売(アンケート無)_納入日 INATK.TOKSP_NNDT DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.TOKSP_NNDT T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 催しコード内部管理 INATK.SYSMOYCD BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.SYSMOYCD
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN, '') || ',' || COALESCE(MOYSSTDT, '') || ',' || COALESCE(MOYSRBAN, '') || ',' || COALESCE(SUMI_KANRINO, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.SYSMOYCD;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催しコード内部管理 INATK.SYSMOYCD DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.SYSMOYCD T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 催し部門内部管理 INATK.SYSMOYBMN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.SYSMOYBMN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMNCD,'')||','||COALESCE(SUMI_KANRINO,'')||','||COALESCE(SUMI_HYOSEQNO,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.SYSMOYBMN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し部門内部管理 INATK.SYSMOYBMN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.SYSMOYBMN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し管理枝番内部管理 INATK.SYSMOYKANRIENO BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.SYSMOYKANRIENO
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMNCD,'')||','||COALESCE(KANRINO,'')||','||COALESCE(SUMI_KANRIENO,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.SYSMOYKANRIENO;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し管理枝番内部管理 INATK.SYSMOYKANRIENO DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.SYSMOYKANRIENO T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% B/M番号内部管理 INATK.SYSBMCD BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.SYSBMCD
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(SUMI_BMNO,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.SYSBMCD;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% B/M番号内部管理 INATK.SYSBMCD DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e"DELETE FROM INATK.SYSBMCD T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% B/M管理番号内部管理 INATK.SYSBM_KANRINO BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.SYSBM_KANRINO
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMNO,'')||','||COALESCE(SUMI_KANRINO,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.SYSBM_KANRINO;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% B/M管理番号内部管理 INATK.SYSBM_KANRINO DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.SYSBM_KANRINO T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% 催し検索 INATK.TOKMM BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKMM
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMFLG,'')||','||COALESCE(HBSTDT,'')||','||COALESCE(HBEDDT,'')||','||COALESCE(NNSTDT,'')||','||COALESCE(NNEDDT,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.TOKMM;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し検索 INATK.TOKMM DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKMM T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% 催し検索_商品 INATK.TOKMM_SHN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKMM_SHN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMFLG,'')||','||COALESCE(BMNO,'')||','||COALESCE(BMNCD,'')||','||COALESCE(KANRINO,'')||','||COALESCE(RPAD(SHNCD,14,' '),'')||','||COALESCE(PARNO,'')||','||COALESCE(CHLDNO,'')||','||COALESCE(ADDSHUKBN,'')||','||COALESCE(HBSTDT,'')||','||COALESCE(HBEDDT,'')||','||COALESCE(NNSTDT,'')||','||COALESCE(NNEDDT,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.TOKMM_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し検索_商品 INATK.TOKMM_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKMM_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR


SET MSG=%DATE% %TIME% 催し検索_店舗 INATK.TOKMM_TEN BACKUP処理
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKMM_TEN
ECHO %OUTFILENAME% >> %OUTFILE%
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(MOYSKBN,'')||','||COALESCE(MOYSSTDT,'')||','||COALESCE(MOYSRBAN,'')||','||COALESCE(BMFLG,'')||','||COALESCE(BMNO,'')||','||COALESCE(BMNCD,'')||','||COALESCE(KANRINO,'')||','||COALESCE(TENCD,'')||','||COALESCE(OPERATOR,'')||','||COALESCE(ADDDT,'')||','||COALESCE(UPDDT,'') FROM INATK.TOKMM_TEN;" >%OUTFILENAME% 2>>%OUTFILE%
IF ERRORLEVEL 1 GOTO ERROR

SET MSG=%DATE% %TIME% 催し検索_店舗 INATK.TOKMM_TEN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKMM_TEN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKMOYCD T2 WHERE T2.MOYSKBN=T1.MOYSKBN AND T2.MOYSSTDT=T1.MOYSSTDT AND T2.MOYSRBAN=T1.MOYSRBAN);commit;" >>%OUTFILE% 2>&1
IF ERRORLEVEL 1 GOTO ERROR





:FINAL
EXIT /B 0

:ERROR
EXIT /B 1
