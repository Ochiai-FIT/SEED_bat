REM [026][069_LOAD]
@ECHO OFF

REM ログフォルダ作成
IF NOT EXIST %~DP0..\logs MKDIR %~DP0..\logs

REM コマンドフォルダ作成
IF NOT EXIST %~DP0..\cmd MKDIR %~DP0..\cmd

REM ログファイルの情報
SET OUTFILE=%~DP0../logs/setup.log
SET OUTTIME=%~DP0../logs/time.log

REM ベースフォルダ
SET BASEDIR=%~DP0..

REM 更新対象の情報
SET INFOSCRIPT=%~DP0..\cmd\%~N0.DB2


SET INFILENAME=
REM バックアップ
SET MSG=%DATE% %TIME% 事前発注 INATK.TOKTJ BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0..\DATA\INATK.TOKTJ
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(TITLE, '') || ',' || COALESCE(STDT, '') || ',' || COALESCE(EDDT, '') || ',' || COALESCE(SHWSTDT, '') || ',' || COALESCE(SHWEDDT, '') || ',' || COALESCE(SNDSIMEDT, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ;" >%OUTFILENAME% 2>>%OUTFILE%
IF NOT %ERRORLEVEL%==0 GOTO ERROR

REM 削除
SET MSG=%DATE% %TIME% 事前発注 INATK.TOKTJ DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ T1 WHERE EXISTS (SELECT 1 FROM (SELECT CAST(DATE_FORMAT(DATE_FORMAT(SHORIDT, '%%Y%%m%%d') - INTERVAL 1 DAY - INTERVAL X.MWDSU DAY, '%%Y%%m%%d') AS SIGNED) AS SHORIDT FROM INAAD.SYSSHORIDT, (SELECT MWDSU FROM INAAD.SYSTOKDELCTL WHERE P_TABLENM = 'TOKTJ' AND PTNCD = '1') X) T2 WHERE T1.EDDT <= T2.SHORIDT);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_商品 INATK.TOKTJ_SHN BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_SHN
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(HYOSEQNO, '') || ',' || COALESCE(SHNCD, '') || ',' || COALESCE(BINKBN, '') || ',' || COALESCE(BINKBNKN, '') || ',' || COALESCE(SANCHIKN, '') || ',' || COALESCE(SHNKN, '') || ',' || COALESCE(ODS, '') || ',' || COALESCE(TANIKBNKN, '') || ',' || COALESCE(NHKETAIKBN, '') || ',' || COALESCE(JRYO, '') || ',' || COALESCE(COMMENTKN, '') || ',' || COALESCE(JISKAVG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_SHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF NOT %ERRORLEVEL%==0 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_商品 INATK.TOKTJ_SHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ_SHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_部門指定荒利 INATK.TOKTJ_BMNSGRS BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_BMNSGRS
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(SGRSRT, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_BMNSGRS;" >%OUTFILENAME% 2>>%OUTFILE%
IF NOT %ERRORLEVEL%==0 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_部門指定荒利 INATK.TOKTJ_BMNSGRS DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ_BMNSGRS T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_大分類指定荒利 INATK.TOKTJ_DAISGRS BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_DAISGRS
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(DAICD, '') || ',' || COALESCE(SGRSRT, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_DAISGRS;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_大分類指定荒利 INATK.TOKTJ_DAISGRS DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ_DAISGRS T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_構成比 INATK.TOKTJ_CMPRT BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_CMPRT
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(DAICD, '') || ',' || COALESCE(TJDT, '') || ',' || COALESCE(URICMPRT, '') || ',' || COALESCE(TBCMPRT, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_CMPRT;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_構成比 INATK.TOKTJ_CMPRT DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ_CMPRT T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_部門予算 INATK.TOKTJ_BMNYSAN BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_BMNYSAN
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(TJDT, '') || ',' || COALESCE(BMNYSANAM, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_BMNYSAN;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_部門予算 INATK.TOKTJ_BMNYSAN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ_BMNYSAN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_部門構成比 INATK.TOKTJ_BMNCMPRT BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_BMNCMPRT
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(SURICMPRT, '') || ',' || COALESCE(SGRSCMPRT, '') || ',' || COALESCE(GRSYSANAM, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_BMNCMPRT;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_部門構成比 INATK.TOKTJ_BMNCMPRT DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ_BMNCMPRT T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_平均パック単価 INATK.TOKTJ_AVGPTANKA BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_AVGPTANKA
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(DAICD, '') || ',' || COALESCE(AVGPTANKA, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_AVGPTANKA;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_平均パック単価 INATK.TOKTJ_AVGPTANKA DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.TOKTJ_AVGPTANKA T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注内部管理 INATK.SYSJT BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.SYSJT
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(SUMI_HYOSEQNO, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.SYSJT;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注内部管理 INATK.SYSJT DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e "DELETE FROM INATK.SYSJT T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_店舗 INATK.TOKTJ_TEN BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_TEN
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(HYOSEQNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(IRISU_RG, '') || ',' || COALESCE(IRISU_TB, '') || ',' || COALESCE(SBAIKAAM_TB, '') || ',' || COALESCE(BAIKAAM_TB, '') || ',' || COALESCE(SBAIKAAM_RG, '') || ',' || COALESCE(BAIKAAM_RG, '') || ',' || COALESCE(GENKAAM_MAE, '') || ',' || COALESCE(GENKAAM_ATO, '') || ',' || COALESCE(GENKAAM_RG, '') || ',' || COALESCE(GENKAAM_PACK, '') || ',' || COALESCE(BAIKAAM_PACK, '') || ',' || COALESCE(JTDT_01, '') || ',' || COALESCE(JTDT_02, '') || ',' || COALESCE(JTDT_03, '') || ',' || COALESCE(JTDT_04, '') || ',' || COALESCE(JTDT_05, '') || ',' || COALESCE(JTDT_06, '') || ',' || COALESCE(JTDT_07, '') || ',' || COALESCE(JTDT_08, '') || ',' || COALESCE(JTDT_09, '') || ',' || COALESCE(JTDT_10, '') || ',' || COALESCE(TSEIKBN_01, '') || ',' || COALESCE(TSEIKBN_02, '') || ',' || COALESCE(TSEIKBN_03, '') || ',' || COALESCE(TSEIKBN_04, '') || ',' || COALESCE(TSEIKBN_05, '') || ',' || COALESCE(TSEIKBN_06, '') || ',' || COALESCE(TSEIKBN_07, '') || ',' || COALESCE(TSEIKBN_08, '') || ',' || COALESCE(TSEIKBN_09, '') || ',' || COALESCE(TSEIKBN_10, '') || ',' || COALESCE(SHNKBN_01, '') || ',' || COALESCE(SHNKBN_02, '') || ',' || COALESCE(SHNKBN_03, '') || ',' || COALESCE(SHNKBN_04, '') || ',' || COALESCE(SHNKBN_05, '') || ',' || COALESCE(SHNKBN_06, '') || ',' || COALESCE(SHNKBN_07, '') || ',' || COALESCE(SHNKBN_08, '') || ',' || COALESCE(SHNKBN_09, '') || ',' || COALESCE(SHNKBN_10, '') || ',' || COALESCE(HTSU_01, '') || ',' || COALESCE(HTSU_02, '') || ',' || COALESCE(HTSU_03, '') || ',' || COALESCE(HTSU_04, '') || ',' || COALESCE(HTSU_05, '') || ',' || COALESCE(HTSU_06, '') || ',' || COALESCE(HTSU_07, '') || ',' || COALESCE(HTSU_08, '') || ',' || COALESCE(HTSU_09, '') || ',' || COALESCE(HTSU_10, '') || ',' || COALESCE(PAGENO, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_TEN;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_店舗 INATK.TOKTJ_TEN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_TEN.DEL
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT LSTNO || ',' || BMNCD || ',' || HYOSEQNO || ',' || TENCD || ',' || COALESCE(IRISU_RG, '') || ',' || COALESCE(IRISU_TB, '') || ',' || COALESCE(SBAIKAAM_TB, '') || ',' || COALESCE(BAIKAAM_TB, '') || ',' || COALESCE(SBAIKAAM_RG, '') || ',' || COALESCE(BAIKAAM_RG, '') || ',' || COALESCE(GENKAAM_MAE, '') || ',' || COALESCE(GENKAAM_ATO, '') || ',' || COALESCE(GENKAAM_RG, '') || ',' || COALESCE(GENKAAM_PACK, '') || ',' || COALESCE(BAIKAAM_PACK, '') || ',' || COALESCE(JTDT_01, '') || ',' || COALESCE(JTDT_02, '') || ',' || COALESCE(JTDT_03, '') || ',' || COALESCE(JTDT_04, '') || ',' || COALESCE(JTDT_05, '') || ',' || COALESCE(JTDT_06, '') || ',' || COALESCE(JTDT_07, '') || ',' || COALESCE(JTDT_08, '') || ',' || COALESCE(JTDT_09, '') || ',' || COALESCE(JTDT_10, '') || ',' || COALESCE(TSEIKBN_01, '') || ',' || COALESCE(TSEIKBN_02, '') || ',' || COALESCE(TSEIKBN_03, '') || ',' || COALESCE(TSEIKBN_04, '') || ',' || COALESCE(TSEIKBN_05, '') || ',' || COALESCE(TSEIKBN_06, '') || ',' || COALESCE(TSEIKBN_07, '') || ',' || COALESCE(TSEIKBN_08, '') || ',' || COALESCE(TSEIKBN_09, '') || ',' || COALESCE(TSEIKBN_10, '') || ',' || COALESCE(SHNKBN_01, '') || ',' || COALESCE(SHNKBN_02, '') || ',' || COALESCE(SHNKBN_03, '') || ',' || COALESCE(SHNKBN_04, '') || ',' || COALESCE(SHNKBN_05, '') || ',' || COALESCE(SHNKBN_06, '') || ',' || COALESCE(SHNKBN_07, '') || ',' || COALESCE(SHNKBN_08, '') || ',' || COALESCE(SHNKBN_09, '') || ',' || COALESCE(SHNKBN_10, '') || ',' || COALESCE(HTSU_01, '') || ',' || COALESCE(HTSU_02, '') || ',' || COALESCE(HTSU_03, '') || ',' || COALESCE(HTSU_04, '') || ',' || COALESCE(HTSU_05, '') || ',' || COALESCE(HTSU_06, '') || ',' || COALESCE(HTSU_07, '') || ',' || COALESCE(HTSU_08, '') || ',' || COALESCE(HTSU_09, '') || ',' || COALESCE(HTSU_10, '') || ',' || COALESCE(PAGENO, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_TEN T1 WHERE EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO = T1.LSTNO);" >%OUTFILENAME% 2>>%OUTFILE%

rem ファイルパスの設定
set filename=DATA\INATK.TOKTJ_TEN.DEL
set filename_tmp=%filename:\=\\%

"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --local_infile=1 --show-warnings -vv -e  "TRUNCATE TABLE INATK.TOKTJ_TEN;load data local infile '%filename_tmp%' IGNORE into table INATK.TOKTJ_TEN character set cp932 fields terminated by ',' ESCAPED BY '' lines terminated by '\r\n' (@1, @2, @3, @4, @5, @6, @7, @8, @9, @10, @11, @12, @13, @14, @15, @16, @17, @18, @19, @20, @21, @22, @23, @24, @25, @26, @27, @28, @29, @30, @31, @32, @33, @34, @35, @36, @37, @38, @39, @40, @41, @42, @43, @44, @45, @46, @47, @48, @49, @50, @51, @52, @53, @54, @55, @56, @57, @58, @59, @60) SET LSTNO = NULLIF(@1, ''), BMNCD = NULLIF(@2, ''), HYOSEQNO = NULLIF(@3, ''), TENCD = NULLIF(@4, ''), IRISU_RG = NULLIF(@5, ''), IRISU_TB = NULLIF(@6, ''), SBAIKAAM_TB = NULLIF(@7, ''), BAIKAAM_TB = NULLIF(@8, ''), SBAIKAAM_RG = NULLIF(@9, ''), BAIKAAM_RG = NULLIF(@10, ''), GENKAAM_MAE = NULLIF(@11, ''), GENKAAM_ATO = NULLIF(@12, ''), GENKAAM_RG = NULLIF(@13, ''), GENKAAM_PACK = NULLIF(@14, ''), BAIKAAM_PACK = NULLIF(@15, ''), JTDT_01 = NULLIF(@16, ''), JTDT_02 = NULLIF(@17, ''), JTDT_03 = NULLIF(@18, ''), JTDT_04 = NULLIF(@19, ''), JTDT_05 = NULLIF(@20, ''), JTDT_06 = NULLIF(@21, ''), JTDT_07 = NULLIF(@22, ''), JTDT_08 = NULLIF(@23, ''), JTDT_09 = NULLIF(@24, ''), JTDT_10 = NULLIF(@25, ''), TSEIKBN_01 = NULLIF(@26, ''), TSEIKBN_02 = NULLIF(@27, ''), TSEIKBN_03 = NULLIF(@28, ''), TSEIKBN_04 = NULLIF(@29, ''), TSEIKBN_05 = NULLIF(@30, ''), TSEIKBN_06 = NULLIF(@31, ''), TSEIKBN_07 = NULLIF(@32, ''), TSEIKBN_08 = NULLIF(@33, ''), TSEIKBN_09 = NULLIF(@34, ''), TSEIKBN_10 = NULLIF(@35, ''), SHNKBN_01 = NULLIF(@36, ''), SHNKBN_02 = NULLIF(@37, ''), SHNKBN_03 = NULLIF(@38, ''), SHNKBN_04 = NULLIF(@39, ''), SHNKBN_05 = NULLIF(@40, ''), SHNKBN_06 = NULLIF(@41, ''), SHNKBN_07 = NULLIF(@42, ''), SHNKBN_08 = NULLIF(@43, ''), SHNKBN_09 = NULLIF(@44, ''), SHNKBN_10 = NULLIF(@45, ''), HTSU_01 = NULLIF(@46, ''), HTSU_02 = NULLIF(@47, ''), HTSU_03 = NULLIF(@48, ''), HTSU_04 = NULLIF(@49, ''), HTSU_05 = NULLIF(@50, ''), HTSU_06 = NULLIF(@51, ''), HTSU_07 = NULLIF(@52, ''), HTSU_08 = NULLIF(@53, ''), HTSU_09 = NULLIF(@54, ''), HTSU_10 = NULLIF(@55, ''), PAGENO = NULLIF(@56, ''), SENDFLG = NULLIF(@57, ''), OPERATOR = NULLIF(@58, ''), ADDDT = NULLIF(DATE_FORMAT(@59, '%%Y-%%m-%%d %%H:%%i:%%s'), ''), UPDDT = NULLIF(DATE_FORMAT(@60, '%%Y-%%m-%%d %%H:%%i:%%s'), '');commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR


SET MSG=%DATE% %TIME% 事前発注_追加商品 INATK.TOKTJ_ADDSHN BACKUP処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
SET OUTFILENAME=%~DP0../DATA/INATK.TOKTJ_ADDSHN
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% -N -e "SELECT COALESCE(LSTNO, '') || ',' || COALESCE(BMNCD, '') || ',' || COALESCE(HYOSEQNO, '') || ',' || COALESCE(TENCD, '') || ',' || COALESCE(SHNCD, '') || ',' || COALESCE(BINKBN, '') || ',' || COALESCE(JTDT_01, '') || ',' || COALESCE(JTDT_02, '') || ',' || COALESCE(JTDT_03, '') || ',' || COALESCE(JTDT_04, '') || ',' || COALESCE(JTDT_05, '') || ',' || COALESCE(JTDT_06, '') || ',' || COALESCE(JTDT_07, '') || ',' || COALESCE(JTDT_08, '') || ',' || COALESCE(JTDT_09, '') || ',' || COALESCE(JTDT_10, '') || ',' || COALESCE(HTSU_01, '') || ',' || COALESCE(HTSU_02, '') || ',' || COALESCE(HTSU_03, '') || ',' || COALESCE(HTSU_04, '') || ',' || COALESCE(HTSU_05, '') || ',' || COALESCE(HTSU_06, '') || ',' || COALESCE(HTSU_07, '') || ',' || COALESCE(HTSU_08, '') || ',' || COALESCE(HTSU_09, '') || ',' || COALESCE(HTSU_10, '') || ',' || COALESCE(PAGENO, '') || ',' || COALESCE(SENDFLG, '') || ',' || COALESCE(OPERATOR, '') || ',' || COALESCE(ADDDT, '') || ',' || COALESCE(UPDDT, '') FROM INATK.TOKTJ_ADDSHN;" >%OUTFILENAME% 2>>%OUTFILE%
IF %ERRORLEVEL% GTR 1 GOTO ERROR

SET MSG=%DATE% %TIME% 事前発注_追加商品 INATK.TOKTJ_ADDSHN DELETE処理
ECHO %MSG%
>> %OUTFILE% ECHO %MSG%
"%MYSQLPATH%mysql" %OPTION% -h %HOST% %DB_NAME% -u %USER_ID% --show-warnings -vv -e  "DELETE FROM INATK.TOKTJ_ADDSHN T1 WHERE NOT EXISTS (SELECT 1 FROM INATK.TOKTJ T2 WHERE T2.LSTNO=T1.LSTNO AND T1.SENDFLG=1);commit;" >>%OUTFILE% 2>&1
IF %ERRORLEVEL% GTR 1 GOTO ERROR

:FINAL
EXIT /B 0

:ERROR
EXIT /B 1
