/*定量特売ファイル（全店特売）テーブル作成*/
TRUNCATE TABLE INAWK.BFB01_Z;
INSERT IGNORE INTO INAWK.BFB01_Z SELECT LPAD(SHOHINCD, 8, 0), FILLER_01, SHOHIN_KBN, T1.BINKBN, NOU_SDATE, NOU_EDATE, HAN_SDATE, HAN_EDATE, NOU_DATE, NOU_DATEYB, HACHU_DATE, HACHU_DATEYB, GEN_TOKJIZEN, TUIKA_GENKA, PACK_GENKA, GEN_1KG, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100G * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100G * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100G * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100G * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.A_BAI_100G END AS A_BAI_100G, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100G * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100G * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100G * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100G * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.B_BAI_100G END AS B_BAI_100G, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100G * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100G * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100G * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100G, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100G * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.C_BAI_100G END AS C_BAI_100G, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_PACK * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_PACK * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_PACK * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_PACK * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.A_BAI_PACK END AS A_BAI_PACK, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_PACK * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_PACK * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_PACK * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_PACK * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.B_BAI_PACK END AS B_BAI_PACK, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_PACK * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_PACK * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_PACK * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_PACK, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_PACK * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.C_BAI_PACK END AS C_BAI_PACK, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1KG * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1KG * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1KG * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1KG * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.A_BAI_1KG END AS A_BAI_1KG, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1KG * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1KG * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1KG * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1KG * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.B_BAI_1KG END AS B_BAI_1KG, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1KG * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1KG * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1KG * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1KG, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1KG * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.C_BAI_1KG END AS C_BAI_1KG, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100GS * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100GS * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100GS * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_100GS * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.A_BAI_100GS END AS A_BAI_100GS, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100GS * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100GS * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100GS * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_100GS * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.B_BAI_100GS END AS B_BAI_100GS, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100GS * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100GS * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100GS * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_100GS, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_100GS * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.C_BAI_100GS END AS C_BAI_100GS, AVGPTANKA, IRISU, TENSUU_BL1, TENSUU_BL2, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1URI * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1URI * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1URI * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_1URI * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.A_BAI_1URI END AS A_BAI_1URI, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL1 * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL1 * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL1 * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL1 * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.A_BAI_BL1 END AS A_BAI_BL1, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL2 * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL2 * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL2 * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.A_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.A_BAI_BL2 * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.A_BAI_BL2 END AS A_BAI_BL2, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1URI * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1URI * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1URI * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_1URI * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.B_BAI_1URI END AS B_BAI_1URI, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL1 * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL1 * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL1 * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL1 * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.B_BAI_BL1 END AS B_BAI_BL1, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL2 * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL2 * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL2 * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.B_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.B_BAI_BL2 * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.B_BAI_BL2 END AS B_BAI_BL2, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1URI * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1URI * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1URI * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_1URI, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_1URI * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.C_BAI_1URI END AS C_BAI_1URI, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL1 * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL1 * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL1 * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL1, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL1 * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.C_BAI_BL1 END AS C_BAI_BL1, CASE WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL2 * MZS1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 0 AND COALESCE(MS.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL2 * MZS2.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) <= COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL2 * MZB1.ZEIRT AS DECIMAL) / 100, 0), 0) WHEN MS.ZEIKBN = 3 AND MB.ZEIKBN = 0 AND COALESCE(MB.ZEIRTHENKODT, 0) > COALESCE(20000000 + T1.EVENT_SDATE, 0) THEN COALESCE(TRUNCATE (T1.C_BAI_BL2, 0), 0) + COALESCE(TRUNCATE (CAST(T1.C_BAI_BL2 * MZB2.ZEIRT AS DECIMAL) / 100, 0), 0) ELSE T1.C_BAI_BL2 END AS C_BAI_BL2, SIRECD, NENMATSU, TEIKBN, TRTEISEK, TTKBN, KZKBN, FUTEIKBN, BETUDEN_KBN, WAPPEN, IKKATK, JIZNUT, SIDENF, TEICUTK, HOUZAI, DSEIK, T1.PCKBN, HIGAWARI_KBN, HGENBAIKA_FLG, REI_DMY_FLG, T1.UPDKBN, SEISUR, HENSUR, SEITK, NONSJ, ATARA, RDHMHYO, RDHMMON, RDHMTUE, RDHMWED, RDHMTHU, RDHMFRI, RDHMSAT, RDHMSUN, NONSU, BUMNCD, DAIBUNCD, CHUBUNCD, SHOBUNCD, SSBUNCD, MSSIRE, MSIR, MSIKK, MSWAP, MSBIN, EVENT_KBN, EVENT_SDATE, EVENT_SEQ, BUMN, KANRI_NO, EVENT_EDANO, WEEK_NO, SMISECD, KZCUT, KOUCUT, TEICUT, TOKCUT, KYUCUT, HACCUT, NONCUT, HSSCUT, ZEROCUT, COALESCE(CAST(FILLER_02 AS CHAR), ' ') AS FILLER_02, SYORIK, TOK_COMMENT, KIKAKU, SANCHI, JIZEN_DATE, JH_LIST_DATE, JH_TORI_DATE, WEEK_HDATE, TAISYO_TEN_RANK, TEN_HSUU_TBL, '', '', '', '', '', FILLER_03, SAKUSEI FROM (SELECT * FROM INAWK.ANWK14_TN06_A WHERE REI_DMY_FLG = 0 UNION ALL SELECT * FROM INAWK.ANWK14_TN06R_A UNION ALL SELECT * FROM INAWK.ANWK14_TN06_N WHERE REI_DMY_FLG = 0 UNION ALL SELECT * FROM INAWK.ANWK14_TN06R_N) T1 LEFT OUTER JOIN INAMS2.MSTSHN MS ON LPAD(SHOHINCD, 8, 0) = MS.SHNCD AND MS.UPDKBN <> 1 LEFT OUTER JOIN INAMS2.MSTBMN MB ON T1.BUMN = MB.BMNCD AND MB.UPDKBN <> 1 LEFT OUTER JOIN INAMS2.MSTZEIRT MZS1 ON MZS1.ZEIRTKBN = MS.ZEIRTKBN AND MZS1.UPDKBN <> 1 LEFT OUTER JOIN INAMS2.MSTZEIRT MZS2 ON MZS2.ZEIRTKBN = MS.ZEIRTKBN_OLD AND MZS2.UPDKBN <> 1 LEFT OUTER JOIN INAMS2.MSTZEIRT MZB1 ON MZB1.ZEIRTKBN = MB.ZEIRTKBN AND MZB1.UPDKBN <> 1 LEFT OUTER JOIN INAMS2.MSTZEIRT MZB2 ON MZB2.ZEIRTKBN = MB.ZEIRTKBN_OLD AND MZB2.UPDKBN <> 1;
COMMIT;
ANALYZE TABLE INAWK.BFB01_Z;
