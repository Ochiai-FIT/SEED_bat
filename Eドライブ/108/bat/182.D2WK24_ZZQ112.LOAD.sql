INSERT IGNORE INTO INAWK.D2WK24_ZZQ112 SELECT 0 AS REC_HAN_KBN, SSHNT.TENCD AS MISE, SSHNT.MOYOK AS MOYOK, SSHNT.MOYOKA AS MOYOKA, SSHNT.MOYORE AS MOYORE, SSHNT.BUNBMC AS BUNBMC, SSHNT.KANBAN AS KANBAN, SSHNT.SHOCD AS SHOCD, SSHNT.MAKRNMKJ AS MAKRNMKJ, SSHNT.SHOMKJ AS SHOMKJ, SSHNT.KIKMKJ AS KIKMKJ, SSHNT.MISIR AS MISIR, SSHNT.SAITEISU AS SAITEISU, SSHNT.GENKA AS GENKA, SSHNT.A_SOBAIFG AS A_SOBAIFG, SSHNT.B_SOBAIFG AS B_SOBAIFG, SSHNT.C_SOBAIFG AS C_SOBAIFG, SSHNT.A_RANK AS A_RANK, SSHNT.B_RANK AS B_RANK, SSHNT.C_RANK AS C_RANK, SSHNT.POPCD AS POPCD, SSHNT.POPSIZE AS POPSIZE, SSHNT.POPSU AS POPSU, SSHNT.MSF AS MSF, SSHNT.KOSINKB AS KOSINKB, SSHNT.SOSINFLG AS SOSINFLG, SSHNT.OPERTO AS OPERTO, SSHNT.TOURKB AS TOURKB, SSHNT.KOSINB AS KOSINB, 0 AS HACHBI, CAST(DATE_FORMAT(SSHNT.KAISIBI + INTERVAL NUM.SEQ DAY, '%Y%m%d') AS SIGNED) AS NNYNOB, CASE WHEN SSHNT.MSF = 'A' THEN SSHNT.A_SOBAIFG WHEN SSHNT.MSF = 'B' THEN SSHNT.B_SOBAIFG WHEN SSHNT.MSF = 'C' THEN SSHNT.C_SOBAIFG END AS BAIKA FROM INAWK.D2WK24_ZZQ112_SSHNT SSHNT INNER JOIN INAWK.D2WK24_ZZQ112_KASAN2 KASAN2 ON 1 = 1 INNER JOIN INAWK.D2WK24_ZZQ112_NUM NUM ON 1 = 1 LEFT OUTER JOIN (SELECT A.SHOHNC FROM INAWK.BFB01_Z A GROUP BY A.SHOHNC) WK23 ON SSHNT.SHOCD = WK23.SHOHNC INNER JOIN (SELECT * FROM INAMS2K.MSTTENBMN WHERE UPDKBN <> 1 AND TENCD BETWEEN 1 AND 400) TBMN ON SSHNT.BUNBMC = TBMN.BMNCD AND SSHNT.TENCD = TBMN.TENCD LEFT OUTER JOIN INAMS2K.MSTBMN BMN ON SSHNT.BUNBMC = BMN.BMNCD AND BMN.UPDKBN <> 1 WHERE ((WK23.SHOHNC IS NULL AND NUM.SEQ <= KASAN2.NISU) OR (WK23.SHOHNC IS NOT NULL)) AND SSHNT.KAISIBI + INTERVAL NUM.SEQ DAY <= SSHNT.SYURYBI;COMMIT
