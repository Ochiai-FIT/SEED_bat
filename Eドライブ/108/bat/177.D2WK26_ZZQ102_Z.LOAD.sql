INSERT IGNORE INTO INAWK.D2WK26_ZZQ102_Z WITH BASE AS (SELECT WK23_2.REC_HAN_KBN, WK23_2.MISE, WK23_2.SHOHNC, WK23_2.FILLER01, WK23_2.SYOKBN, WK23_2.SETBINK, WK23_2.NOKAIS, WK23_2.NOSYUR, WK23_2.HAKAIS, WK23_2.HASYUR, WK23_2.NNYNOB, WK23_2.NONYB, CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN WK23_2.SETHACHBI WHEN WK23_2.NNYNOB = NNYNOB11_H THEN WK23_2.NNYNOB11 WHEN WK23_2.NNYNOB = NNYNOB10_H THEN WK23_2.NNYNOB10 WHEN WK23_2.NNYNOB = NNYNOB09_H THEN WK23_2.NNYNOB09 WHEN WK23_2.NNYNOB = NNYNOB08_H THEN WK23_2.NNYNOB08 WHEN WK23_2.NNYNOB = NNYNOB07_H THEN WK23_2.NNYNOB07 WHEN WK23_2.NNYNOB = NNYNOB06_H THEN WK23_2.NNYNOB06 WHEN WK23_2.NNYNOB = NNYNOB05_H THEN WK23_2.NNYNOB05 WHEN WK23_2.NNYNOB = NNYNOB04_H THEN WK23_2.NNYNOB04 WHEN WK23_2.NNYNOB = NNYNOB03_H THEN WK23_2.NNYNOB03 WHEN WK23_2.NNYNOB = NNYNOB02_H THEN WK23_2.NNYNOB02 WHEN WK23_2.NNYNOB = NNYNOB01_H THEN WK23_2.NNYNOB01 WHEN WK23_2.NNYNOB = NNYNOB00_H THEN WK23_2.NNYNOB00 ELSE 0 END AS HACHBI, CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN WK23_2.SETHACYB WHEN WK23_2.NNYNOB = NNYNOB11_H THEN WK23_2.NNYNOWEK11 WHEN WK23_2.NNYNOB = NNYNOB10_H THEN WK23_2.NNYNOWEK10 WHEN WK23_2.NNYNOB = NNYNOB09_H THEN WK23_2.NNYNOWEK09 WHEN WK23_2.NNYNOB = NNYNOB08_H THEN WK23_2.NNYNOWEK08 WHEN WK23_2.NNYNOB = NNYNOB07_H THEN WK23_2.NNYNOWEK07 WHEN WK23_2.NNYNOB = NNYNOB06_H THEN WK23_2.NNYNOWEK06 WHEN WK23_2.NNYNOB = NNYNOB05_H THEN WK23_2.NNYNOWEK05 WHEN WK23_2.NNYNOB = NNYNOB04_H THEN WK23_2.NNYNOWEK04 WHEN WK23_2.NNYNOB = NNYNOB03_H THEN WK23_2.NNYNOWEK03 WHEN WK23_2.NNYNOB = NNYNOB02_H THEN WK23_2.NNYNOWEK02 WHEN WK23_2.NNYNOB = NNYNOB01_H THEN WK23_2.NNYNOWEK01 WHEN WK23_2.NNYNOB = NNYNOB00_H THEN WK23_2.NNYNOWEK00 ELSE 0 END AS HACYB, WK23_2.JZNGENKA, WK23_2.TUIGENKA, WK23_2.GENFU, WK23_2.GENFUK, WK23_2.A_SOBAIFG, WK23_2.B_SOBAIFG, WK23_2.C_SOBAIFG, WK23_2.A_SOBAIFP, WK23_2.B_SOBAIFP, WK23_2.C_SOBAIFP, WK23_2.A_SOBAIFK, WK23_2.B_SOBAIFK, WK23_2.C_SOBAIFK, WK23_2.A_BAIKA_SOTO, WK23_2.B_BAIKA_SOTO, WK23_2.C_BAIKA_SOTO, WK23_2.HEKINP, WK23_2.SETIRISU, WK23_2.BD1SU, WK23_2.BD2SU, WK23_2.A_BDBAIKA, WK23_2.A_BD1BAIKA, WK23_2.A_BD2BAIKA, WK23_2.B_BDBAIKA, WK23_2.B_BD1BAIKA, WK23_2.B_BD2BAIKA, WK23_2.C_BDBAIKA, WK23_2.C_BD1BAIKA, WK23_2.C_BD2BAIKA, WK23_2.SIIRCD, WK23_2.NENMAT, WK23_2.TEISEK, WK23_2.TRTEISEK, WK23_2.TTKBN, WK23_2.KZKBN, WK23_2.TEFTEI, WK23_2.BETUDEN, WK23_2.WAPENK, WK23_2.IKKATK, WK23_2.JIZNUT, WK23_2.SIDENF, WK23_2.TEICUTK, WK23_2.HOUZAI, WK23_2.DSEIK, WK23_2.PCKBN, WK23_2.HIGAWAK, WK23_2.HGEBATFL, WK23_2.REDMYFL, WK23_2.DATAK, WK23_2.SEISUR, WK23_2.HENSUR, WK23_2.SEITK, WK23_2.NONSJ, WK23_2.ATARA, WK23_2.RDHMHYO, CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_MONSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_MON11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_MON10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_MON09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_MON08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_MON07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_MON06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_MON05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_MON04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_MON03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_MON02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_MON01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_MON00 AS CHAR (1)) END AS RDHMMON, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_TUESH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_TUE11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_TUE10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_TUE09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_TUE08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_TUE07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_TUE06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_TUE05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_TUE04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_TUE03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_TUE02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_TUE01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_TUE00 AS CHAR (1)) END AS CHAR (1)) AS RDHMTUE, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_WEDSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_WED11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_WED10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_WED09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_WED08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_WED07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_WED06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_WED05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_WED04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_WED03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_WED02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_WED01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_WED00 AS CHAR (1)) END AS CHAR (1)) AS RDHMWED, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_THUSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_THU11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_THU10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_THU09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_THU08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_THU07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_THU06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_THU05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_THU04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_THU03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_THU02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_THU01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_THU00 AS CHAR (1)) END AS CHAR (1)) AS RDHMTHU, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_FRISH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_FRI11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_FRI10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_FRI09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_FRI08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_FRI07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_FRI06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_FRI05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_FRI04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_FRI03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_FRI02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_FRI01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_FRI00 AS CHAR (1)) END AS CHAR (1)) AS RDHMFRI, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_SATSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_SAT11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_SAT10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_SAT09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_SAT08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_SAT07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_SAT06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_SAT05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_SAT04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_SAT03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_SAT02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_SAT01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_SAT00 AS CHAR (1)) END AS CHAR (1)) AS RDHMSAT, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_SUNSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_SUN11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_SUN10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_SUN09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_SUN08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_SUN07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_SUN06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_SUN05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_SUN04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_SUN03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_SUN02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_SUN01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_SUN00 AS CHAR (1)) END AS CHAR (1)) AS RDHMSUN, WK23_2.NONSU, WK23_2.BUNBMC1, WK23_2.BUNDIC, WK23_2.BUNCHC, WK23_2.BUNSHC, WK23_2.BUNSSC, WK23_2.MSSIRE, WK23_2.MSIR, WK23_2.MSIKK, WK23_2.MSWAP, WK23_2.MSBIN, WK23_2.MOYOK, WK23_2.MOYOKA, WK23_2.MOYORE, WK23_2.BUNBMC2, WK23_2.KANBAN, WK23_2.EDABAN, WK23_2.SHUNO, WK23_2.SMISECD, WK23_2.KZCUT, WK23_2.KOUCUT, WK23_2.TEICUT, WK23_2.TOKCUT, WK23_2.KYUCUT, WK23_2.HACCUT, WK23_2.NONCUT, WK23_2.HSSCUT, WK23_2.ZERO, WK23_2.FILLER02, WK23_2.SYORIK, WK23_2.TOKCOME, WK23_2.KIKMKJ, WK23_2.SANTIMKJ, WK23_2.JIZNB, WK23_2.JZHCB, WK23_2.JZHCSUB, WK23_2.SIHCSYB, WK23_2.TTENRANK, WK23_2.HCUSU, WK23_2.BAISNKB, WK23_2.KZKUBETU, WK23_2.SYUFLG, WK23_2.HYSYUFLG, WK23_2.JZNLSKSKB, WK23_2.ANKUMUKB, WK23_2.FILLER03, WK23_2.SAKSEIB, WK23_2.ATSUK_STDT, WK23_2.ATSUK_EDDT, WK23_2.TEISHIKBN FROM (SELECT WK23_1.*, CASE WHEN CASE WHEN WK23_1.NNYNOWEK00 = 0 THEN 0 WHEN WK23_1.NNYNOWEK00 = 1 THEN PRRTM00.READTM_MON WHEN WK23_1.NNYNOWEK00 = 2 THEN PRRTM00.READTM_TUE WHEN WK23_1.NNYNOWEK00 = 3 THEN PRRTM00.READTM_WED WHEN WK23_1.NNYNOWEK00 = 4 THEN PRRTM00.READTM_THU WHEN WK23_1.NNYNOWEK00 = 5 THEN PRRTM00.READTM_FRI WHEN WK23_1.NNYNOWEK00 = 6 THEN PRRTM00.READTM_SAT WHEN WK23_1.NNYNOWEK00 = 7 THEN PRRTM00.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB00, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK00 = 1 THEN PRRTM00.READTM_MON WHEN WK23_1.NNYNOWEK00 = 2 THEN PRRTM00.READTM_TUE WHEN WK23_1.NNYNOWEK00 = 3 THEN PRRTM00.READTM_WED WHEN WK23_1.NNYNOWEK00 = 4 THEN PRRTM00.READTM_THU WHEN WK23_1.NNYNOWEK00 = 5 THEN PRRTM00.READTM_FRI WHEN WK23_1.NNYNOWEK00 = 6 THEN PRRTM00.READTM_SAT WHEN WK23_1.NNYNOWEK00 = 7 THEN PRRTM00.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB00_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK01 = 0 THEN 0 WHEN WK23_1.NNYNOWEK01 = 1 THEN PRRTM01.READTM_MON WHEN WK23_1.NNYNOWEK01 = 2 THEN PRRTM01.READTM_TUE WHEN WK23_1.NNYNOWEK01 = 3 THEN PRRTM01.READTM_WED WHEN WK23_1.NNYNOWEK01 = 4 THEN PRRTM01.READTM_THU WHEN WK23_1.NNYNOWEK01 = 5 THEN PRRTM01.READTM_FRI WHEN WK23_1.NNYNOWEK01 = 6 THEN PRRTM01.READTM_SAT WHEN WK23_1.NNYNOWEK01 = 7 THEN PRRTM01.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB01, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK01 = 1 THEN PRRTM01.READTM_MON WHEN WK23_1.NNYNOWEK01 = 2 THEN PRRTM01.READTM_TUE WHEN WK23_1.NNYNOWEK01 = 3 THEN PRRTM01.READTM_WED WHEN WK23_1.NNYNOWEK01 = 4 THEN PRRTM01.READTM_THU WHEN WK23_1.NNYNOWEK01 = 5 THEN PRRTM01.READTM_FRI WHEN WK23_1.NNYNOWEK01 = 6 THEN PRRTM01.READTM_SAT WHEN WK23_1.NNYNOWEK01 = 7 THEN PRRTM01.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB01_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK02 = 0 THEN 0 WHEN WK23_1.NNYNOWEK02 = 1 THEN PRRTM02.READTM_MON WHEN WK23_1.NNYNOWEK02 = 2 THEN PRRTM02.READTM_TUE WHEN WK23_1.NNYNOWEK02 = 3 THEN PRRTM02.READTM_WED WHEN WK23_1.NNYNOWEK02 = 4 THEN PRRTM02.READTM_THU WHEN WK23_1.NNYNOWEK02 = 5 THEN PRRTM02.READTM_FRI WHEN WK23_1.NNYNOWEK02 = 6 THEN PRRTM02.READTM_SAT WHEN WK23_1.NNYNOWEK02 = 7 THEN PRRTM02.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB02, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK02 = 1 THEN PRRTM02.READTM_MON WHEN WK23_1.NNYNOWEK02 = 2 THEN PRRTM02.READTM_TUE WHEN WK23_1.NNYNOWEK02 = 3 THEN PRRTM02.READTM_WED WHEN WK23_1.NNYNOWEK02 = 4 THEN PRRTM02.READTM_THU WHEN WK23_1.NNYNOWEK02 = 5 THEN PRRTM02.READTM_FRI WHEN WK23_1.NNYNOWEK02 = 6 THEN PRRTM02.READTM_SAT WHEN WK23_1.NNYNOWEK02 = 7 THEN PRRTM02.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB02_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK03 = 0 THEN 0 WHEN WK23_1.NNYNOWEK03 = 1 THEN PRRTM03.READTM_MON WHEN WK23_1.NNYNOWEK03 = 2 THEN PRRTM03.READTM_TUE WHEN WK23_1.NNYNOWEK03 = 3 THEN PRRTM03.READTM_WED WHEN WK23_1.NNYNOWEK03 = 4 THEN PRRTM03.READTM_THU WHEN WK23_1.NNYNOWEK03 = 5 THEN PRRTM03.READTM_FRI WHEN WK23_1.NNYNOWEK03 = 6 THEN PRRTM03.READTM_SAT WHEN WK23_1.NNYNOWEK03 = 7 THEN PRRTM03.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB03, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK03 = 1 THEN PRRTM03.READTM_MON WHEN WK23_1.NNYNOWEK03 = 2 THEN PRRTM03.READTM_TUE WHEN WK23_1.NNYNOWEK03 = 3 THEN PRRTM03.READTM_WED WHEN WK23_1.NNYNOWEK03 = 4 THEN PRRTM03.READTM_THU WHEN WK23_1.NNYNOWEK03 = 5 THEN PRRTM03.READTM_FRI WHEN WK23_1.NNYNOWEK03 = 6 THEN PRRTM03.READTM_SAT WHEN WK23_1.NNYNOWEK03 = 7 THEN PRRTM03.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB03_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK04 = 0 THEN 0 WHEN WK23_1.NNYNOWEK04 = 1 THEN PRRTM04.READTM_MON WHEN WK23_1.NNYNOWEK04 = 2 THEN PRRTM04.READTM_TUE WHEN WK23_1.NNYNOWEK04 = 3 THEN PRRTM04.READTM_WED WHEN WK23_1.NNYNOWEK04 = 4 THEN PRRTM04.READTM_THU WHEN WK23_1.NNYNOWEK04 = 5 THEN PRRTM04.READTM_FRI WHEN WK23_1.NNYNOWEK04 = 6 THEN PRRTM04.READTM_SAT WHEN WK23_1.NNYNOWEK04 = 7 THEN PRRTM04.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB04, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK04 = 1 THEN PRRTM04.READTM_MON WHEN WK23_1.NNYNOWEK04 = 2 THEN PRRTM04.READTM_TUE WHEN WK23_1.NNYNOWEK04 = 3 THEN PRRTM04.READTM_WED WHEN WK23_1.NNYNOWEK04 = 4 THEN PRRTM04.READTM_THU WHEN WK23_1.NNYNOWEK04 = 5 THEN PRRTM04.READTM_FRI WHEN WK23_1.NNYNOWEK04 = 6 THEN PRRTM04.READTM_SAT WHEN WK23_1.NNYNOWEK04 = 7 THEN PRRTM04.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB04_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK05 = 0 THEN 0 WHEN WK23_1.NNYNOWEK05 = 1 THEN PRRTM05.READTM_MON WHEN WK23_1.NNYNOWEK05 = 2 THEN PRRTM05.READTM_TUE WHEN WK23_1.NNYNOWEK05 = 3 THEN PRRTM05.READTM_WED WHEN WK23_1.NNYNOWEK05 = 4 THEN PRRTM05.READTM_THU WHEN WK23_1.NNYNOWEK05 = 5 THEN PRRTM05.READTM_FRI WHEN WK23_1.NNYNOWEK05 = 6 THEN PRRTM05.READTM_SAT WHEN WK23_1.NNYNOWEK05 = 7 THEN PRRTM05.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB05, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK05 = 1 THEN PRRTM05.READTM_MON WHEN WK23_1.NNYNOWEK05 = 2 THEN PRRTM05.READTM_TUE WHEN WK23_1.NNYNOWEK05 = 3 THEN PRRTM05.READTM_WED WHEN WK23_1.NNYNOWEK05 = 4 THEN PRRTM05.READTM_THU WHEN WK23_1.NNYNOWEK05 = 5 THEN PRRTM05.READTM_FRI WHEN WK23_1.NNYNOWEK05 = 6 THEN PRRTM05.READTM_SAT WHEN WK23_1.NNYNOWEK05 = 7 THEN PRRTM05.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB05_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK06 = 0 THEN 0 WHEN WK23_1.NNYNOWEK06 = 1 THEN PRRTM06.READTM_MON WHEN WK23_1.NNYNOWEK06 = 2 THEN PRRTM06.READTM_TUE WHEN WK23_1.NNYNOWEK06 = 3 THEN PRRTM06.READTM_WED WHEN WK23_1.NNYNOWEK06 = 4 THEN PRRTM06.READTM_THU WHEN WK23_1.NNYNOWEK06 = 5 THEN PRRTM06.READTM_FRI WHEN WK23_1.NNYNOWEK06 = 6 THEN PRRTM06.READTM_SAT WHEN WK23_1.NNYNOWEK06 = 7 THEN PRRTM06.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB06, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK06 = 1 THEN PRRTM06.READTM_MON WHEN WK23_1.NNYNOWEK06 = 2 THEN PRRTM06.READTM_TUE WHEN WK23_1.NNYNOWEK06 = 3 THEN PRRTM06.READTM_WED WHEN WK23_1.NNYNOWEK06 = 4 THEN PRRTM06.READTM_THU WHEN WK23_1.NNYNOWEK06 = 5 THEN PRRTM06.READTM_FRI WHEN WK23_1.NNYNOWEK06 = 6 THEN PRRTM06.READTM_SAT WHEN WK23_1.NNYNOWEK06 = 7 THEN PRRTM06.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB06_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK07 = 0 THEN 0 WHEN WK23_1.NNYNOWEK07 = 1 THEN PRRTM07.READTM_MON WHEN WK23_1.NNYNOWEK07 = 2 THEN PRRTM07.READTM_TUE WHEN WK23_1.NNYNOWEK07 = 3 THEN PRRTM07.READTM_WED WHEN WK23_1.NNYNOWEK07 = 4 THEN PRRTM07.READTM_THU WHEN WK23_1.NNYNOWEK07 = 5 THEN PRRTM07.READTM_FRI WHEN WK23_1.NNYNOWEK07 = 6 THEN PRRTM07.READTM_SAT WHEN WK23_1.NNYNOWEK07 = 7 THEN PRRTM07.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB07, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK07 = 1 THEN PRRTM07.READTM_MON WHEN WK23_1.NNYNOWEK07 = 2 THEN PRRTM07.READTM_TUE WHEN WK23_1.NNYNOWEK07 = 3 THEN PRRTM07.READTM_WED WHEN WK23_1.NNYNOWEK07 = 4 THEN PRRTM07.READTM_THU WHEN WK23_1.NNYNOWEK07 = 5 THEN PRRTM07.READTM_FRI WHEN WK23_1.NNYNOWEK07 = 6 THEN PRRTM07.READTM_SAT WHEN WK23_1.NNYNOWEK07 = 7 THEN PRRTM07.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB07_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK08 = 0 THEN 0 WHEN WK23_1.NNYNOWEK08 = 1 THEN PRRTM08.READTM_MON WHEN WK23_1.NNYNOWEK08 = 2 THEN PRRTM08.READTM_TUE WHEN WK23_1.NNYNOWEK08 = 3 THEN PRRTM08.READTM_WED WHEN WK23_1.NNYNOWEK08 = 4 THEN PRRTM08.READTM_THU WHEN WK23_1.NNYNOWEK08 = 5 THEN PRRTM08.READTM_FRI WHEN WK23_1.NNYNOWEK08 = 6 THEN PRRTM08.READTM_SAT WHEN WK23_1.NNYNOWEK08 = 7 THEN PRRTM08.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB08, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK08 = 1 THEN PRRTM08.READTM_MON WHEN WK23_1.NNYNOWEK08 = 2 THEN PRRTM08.READTM_TUE WHEN WK23_1.NNYNOWEK08 = 3 THEN PRRTM08.READTM_WED WHEN WK23_1.NNYNOWEK08 = 4 THEN PRRTM08.READTM_THU WHEN WK23_1.NNYNOWEK08 = 5 THEN PRRTM08.READTM_FRI WHEN WK23_1.NNYNOWEK08 = 6 THEN PRRTM08.READTM_SAT WHEN WK23_1.NNYNOWEK08 = 7 THEN PRRTM08.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB08_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK09 = 0 THEN 0 WHEN WK23_1.NNYNOWEK09 = 1 THEN PRRTM09.READTM_MON WHEN WK23_1.NNYNOWEK09 = 2 THEN PRRTM09.READTM_TUE WHEN WK23_1.NNYNOWEK09 = 3 THEN PRRTM09.READTM_WED WHEN WK23_1.NNYNOWEK09 = 4 THEN PRRTM09.READTM_THU WHEN WK23_1.NNYNOWEK09 = 5 THEN PRRTM09.READTM_FRI WHEN WK23_1.NNYNOWEK09 = 6 THEN PRRTM09.READTM_SAT WHEN WK23_1.NNYNOWEK09 = 7 THEN PRRTM09.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB09, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK09 = 1 THEN PRRTM09.READTM_MON WHEN WK23_1.NNYNOWEK09 = 2 THEN PRRTM09.READTM_TUE WHEN WK23_1.NNYNOWEK09 = 3 THEN PRRTM09.READTM_WED WHEN WK23_1.NNYNOWEK09 = 4 THEN PRRTM09.READTM_THU WHEN WK23_1.NNYNOWEK09 = 5 THEN PRRTM09.READTM_FRI WHEN WK23_1.NNYNOWEK09 = 6 THEN PRRTM09.READTM_SAT WHEN WK23_1.NNYNOWEK09 = 7 THEN PRRTM09.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB09_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK10 = 0 THEN 0 WHEN WK23_1.NNYNOWEK10 = 1 THEN PRRTM10.READTM_MON WHEN WK23_1.NNYNOWEK10 = 2 THEN PRRTM10.READTM_TUE WHEN WK23_1.NNYNOWEK10 = 3 THEN PRRTM10.READTM_WED WHEN WK23_1.NNYNOWEK10 = 4 THEN PRRTM10.READTM_THU WHEN WK23_1.NNYNOWEK10 = 5 THEN PRRTM10.READTM_FRI WHEN WK23_1.NNYNOWEK10 = 6 THEN PRRTM10.READTM_SAT WHEN WK23_1.NNYNOWEK10 = 7 THEN PRRTM10.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB10, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK10 = 1 THEN PRRTM10.READTM_MON WHEN WK23_1.NNYNOWEK10 = 2 THEN PRRTM10.READTM_TUE WHEN WK23_1.NNYNOWEK10 = 3 THEN PRRTM10.READTM_WED WHEN WK23_1.NNYNOWEK10 = 4 THEN PRRTM10.READTM_THU WHEN WK23_1.NNYNOWEK10 = 5 THEN PRRTM10.READTM_FRI WHEN WK23_1.NNYNOWEK10 = 6 THEN PRRTM10.READTM_SAT WHEN WK23_1.NNYNOWEK10 = 7 THEN PRRTM10.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB10_H, CASE WHEN CASE WHEN WK23_1.NNYNOWEK11 = 0 THEN 0 WHEN WK23_1.NNYNOWEK11 = 1 THEN PRRTM11.READTM_MON WHEN WK23_1.NNYNOWEK11 = 2 THEN PRRTM11.READTM_TUE WHEN WK23_1.NNYNOWEK11 = 3 THEN PRRTM11.READTM_WED WHEN WK23_1.NNYNOWEK11 = 4 THEN PRRTM11.READTM_THU WHEN WK23_1.NNYNOWEK11 = 5 THEN PRRTM11.READTM_FRI WHEN WK23_1.NNYNOWEK11 = 6 THEN PRRTM11.READTM_SAT WHEN WK23_1.NNYNOWEK11 = 7 THEN PRRTM11.READTM_SUN END = 0 THEN '0' ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(WK23_1.NNYNOB11, '%Y%m%d'), INTERVAL + CASE WHEN WK23_1.NNYNOWEK11 = 1 THEN PRRTM11.READTM_MON WHEN WK23_1.NNYNOWEK11 = 2 THEN PRRTM11.READTM_TUE WHEN WK23_1.NNYNOWEK11 = 3 THEN PRRTM11.READTM_WED WHEN WK23_1.NNYNOWEK11 = 4 THEN PRRTM11.READTM_THU WHEN WK23_1.NNYNOWEK11 = 5 THEN PRRTM11.READTM_FRI WHEN WK23_1.NNYNOWEK11 = 6 THEN PRRTM11.READTM_SAT WHEN WK23_1.NNYNOWEK11 = 7 THEN PRRTM11.READTM_SUN END DAY), '%Y%m%d') END AS NNYNOB11_H, PRRTM00.READTM_MON AS READTM_MON00, PRRTM00.READTM_TUE AS READTM_TUE00, PRRTM00.READTM_WED AS READTM_WED00, PRRTM00.READTM_THU AS READTM_THU00, PRRTM00.READTM_FRI AS READTM_FRI00, PRRTM00.READTM_SAT AS READTM_SAT00, PRRTM00.READTM_SUN AS READTM_SUN00, PRRTM01.READTM_MON AS READTM_MON01, PRRTM01.READTM_TUE AS READTM_TUE01, PRRTM01.READTM_WED AS READTM_WED01, PRRTM01.READTM_THU AS READTM_THU01, PRRTM01.READTM_FRI AS READTM_FRI01, PRRTM01.READTM_SAT AS READTM_SAT01, PRRTM01.READTM_SUN AS READTM_SUN01, PRRTM02.READTM_MON AS READTM_MON02, PRRTM02.READTM_TUE AS READTM_TUE02, PRRTM02.READTM_WED AS READTM_WED02, PRRTM02.READTM_THU AS READTM_THU02, PRRTM02.READTM_FRI AS READTM_FRI02, PRRTM02.READTM_SAT AS READTM_SAT02, PRRTM02.READTM_SUN AS READTM_SUN02, PRRTM03.READTM_MON AS READTM_MON03, PRRTM03.READTM_TUE AS READTM_TUE03, PRRTM03.READTM_WED AS READTM_WED03, PRRTM03.READTM_THU AS READTM_THU03, PRRTM03.READTM_FRI AS READTM_FRI03, PRRTM03.READTM_SAT AS READTM_SAT03, PRRTM03.READTM_SUN AS READTM_SUN03, PRRTM04.READTM_MON AS READTM_MON04, PRRTM04.READTM_TUE AS READTM_TUE04, PRRTM04.READTM_WED AS READTM_WED04, PRRTM04.READTM_THU AS READTM_THU04, PRRTM04.READTM_FRI AS READTM_FRI04, PRRTM04.READTM_SAT AS READTM_SAT04, PRRTM04.READTM_SUN AS READTM_SUN04, PRRTM05.READTM_MON AS READTM_MON05, PRRTM05.READTM_TUE AS READTM_TUE05, PRRTM05.READTM_WED AS READTM_WED05, PRRTM05.READTM_THU AS READTM_THU05, PRRTM05.READTM_FRI AS READTM_FRI05, PRRTM05.READTM_SAT AS READTM_SAT05, PRRTM05.READTM_SUN AS READTM_SUN05, PRRTM06.READTM_MON AS READTM_MON06, PRRTM06.READTM_TUE AS READTM_TUE06, PRRTM06.READTM_WED AS READTM_WED06, PRRTM06.READTM_THU AS READTM_THU06, PRRTM06.READTM_FRI AS READTM_FRI06, PRRTM06.READTM_SAT AS READTM_SAT06, PRRTM06.READTM_SUN AS READTM_SUN06, PRRTM07.READTM_MON AS READTM_MON07, PRRTM07.READTM_TUE AS READTM_TUE07, PRRTM07.READTM_WED AS READTM_WED07, PRRTM07.READTM_THU AS READTM_THU07, PRRTM07.READTM_FRI AS READTM_FRI07, PRRTM07.READTM_SAT AS READTM_SAT07, PRRTM07.READTM_SUN AS READTM_SUN07, PRRTM08.READTM_MON AS READTM_MON08, PRRTM08.READTM_TUE AS READTM_TUE08, PRRTM08.READTM_WED AS READTM_WED08, PRRTM08.READTM_THU AS READTM_THU08, PRRTM08.READTM_FRI AS READTM_FRI08, PRRTM08.READTM_SAT AS READTM_SAT08, PRRTM08.READTM_SUN AS READTM_SUN08, PRRTM09.READTM_MON AS READTM_MON09, PRRTM09.READTM_TUE AS READTM_TUE09, PRRTM09.READTM_WED AS READTM_WED09, PRRTM09.READTM_THU AS READTM_THU09, PRRTM09.READTM_FRI AS READTM_FRI09, PRRTM09.READTM_SAT AS READTM_SAT09, PRRTM09.READTM_SUN AS READTM_SUN09, PRRTM10.READTM_MON AS READTM_MON10, PRRTM10.READTM_TUE AS READTM_TUE10, PRRTM10.READTM_WED AS READTM_WED10, PRRTM10.READTM_THU AS READTM_THU10, PRRTM10.READTM_FRI AS READTM_FRI10, PRRTM10.READTM_SAT AS READTM_SAT10, PRRTM10.READTM_SUN AS READTM_SUN10, PRRTM11.READTM_MON AS READTM_MON11, PRRTM11.READTM_TUE AS READTM_TUE11, PRRTM11.READTM_WED AS READTM_WED11, PRRTM11.READTM_THU AS READTM_THU11, PRRTM11.READTM_FRI AS READTM_FRI11, PRRTM11.READTM_SAT AS READTM_SAT11, PRRTM11.READTM_SUN AS READTM_SUN11, PRRTMSH.READTM_MON AS READTM_MONSH, PRRTMSH.READTM_TUE AS READTM_TUESH, PRRTMSH.READTM_WED AS READTM_WEDSH, PRRTMSH.READTM_THU AS READTM_THUSH, PRRTMSH.READTM_FRI AS READTM_FRISH, PRRTMSH.READTM_SAT AS READTM_SATSH, PRRTMSH.READTM_SUN AS READTM_SUNSH, CASE WHEN SHN.PCKBN = 0 THEN SHN.BINKBN ELSE WK23_1.BINK END AS SETBINK, CASE WHEN WK23_1.MISIR = 0 AND WK23_1.SYOKBN = 0 THEN SHN.RG_IRISU WHEN WK23_1.MISIR = 0 AND WK23_1.SYOKBN <> 0 AND SHN.HS_IRISU = 0 THEN SHN.RG_IRISU WHEN WK23_1.MISIR = 0 AND WK23_1.SYOKBN <> 0 THEN SHN.HS_IRISU ELSE WK23_1.MISIR END AS SETIRISU, BMN.BMNKBN, SHN.ATSUK_STDT, SHN.ATSUK_EDDT, SHN.TEISHIKBN FROM (SELECT TIR.*, TIR.NNYNOB AS NNYNOB00, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 1 DAY), '%Y%m%d') END AS NNYNOB01, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 2 DAY), '%Y%m%d') END AS NNYNOB02, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 3 DAY), '%Y%m%d') END AS NNYNOB03, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 4 DAY), '%Y%m%d') END AS NNYNOB04, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 5 DAY), '%Y%m%d') END AS NNYNOB05, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 6 DAY), '%Y%m%d') END AS NNYNOB06, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 7 DAY), '%Y%m%d') END AS NNYNOB07, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 8 DAY), '%Y%m%d') END AS NNYNOB08, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 9 DAY), '%Y%m%d') END AS NNYNOB09, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 10 DAY), '%Y%m%d') END AS NNYNOB10, CASE WHEN TIR.NNYNOB = 0 THEN TIR.NNYNOB ELSE DATE_FORMAT(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 11 DAY), '%Y%m%d') END AS NNYNOB11, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 0 DAY)) + 1 END AS NNYNOWEK00, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 1 DAY)) + 1 END AS NNYNOWEK01, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 2 DAY)) + 1 END AS NNYNOWEK02, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 3 DAY)) + 1 END AS NNYNOWEK03, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 4 DAY)) + 1 END AS NNYNOWEK04, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 5 DAY)) + 1 END AS NNYNOWEK05, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 6 DAY)) + 1 END AS NNYNOWEK06, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 7 DAY)) + 1 END AS NNYNOWEK07, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 8 DAY)) + 1 END AS NNYNOWEK08, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 9 DAY)) + 1 END AS NNYNOWEK09, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 10 DAY)) + 1 END AS NNYNOWEK10, CASE WHEN TIR.NNYNOB = 0 THEN 0 ELSE WEEKDAY(DATE_ADD(DATE_FORMAT(TIR.NNYNOB, '%Y%m%d'), INTERVAL - 11 DAY)) + 1 END AS NNYNOWEK11, CASE WHEN TIR.JIZNUT = 2 THEN TIR.JIZNB ELSE TIR.HACHBI END AS SETHACHBI, CASE WHEN TIR.JIZNUT = 2 THEN CASE WHEN COALESCE(TIR.JIZNB, 0) = 0 THEN 0 ELSE WEEKDAY(DATE_FORMAT(TIR.JIZNB, '%Y%m%d')) + 1 END ELSE TIR.HACYB END AS SETHACYB FROM (SELECT * FROM INAWK.D2WK21_ZZQ102 WK21 WHERE WK21.HACHBI = 0 AND WK21.NNYNOB > 0 UNION ALL SELECT * FROM INAWK.D2WK22_ZZQ102 WK22 WHERE WK22.HACHBI = 0 AND WK22.NNYNOB > 0) TIR) WK23_1 INNER JOIN INAPARM.SYSBATCHDT_HA SBD ON SBD.SMODE = 'DAILY' INNER JOIN INAPRE.MSTSHN_PD SHN ON WK23_1.SHOHNC = SHN.SHNCD AND SHN.UPDKBN <> 1 LEFT OUTER JOIN INAMS2K.MSTBMN BMN ON WK23_1.BUNBMC1 = BMN.BMNCD AND BMN.UPDKBN <> 1 LEFT OUTER JOIN INAMS2K.MSTTENBMN TBMN ON WK23_1.MISE = TBMN.TENCD AND WK23_1.BUNBMC1 = TBMN.BMNCD AND TBMN.UPDKBN <> 1 LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC00 ON WK23_1.NNYNOB00 = PRRTC00.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC00.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC00.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM00 ON WK23_1.NNYNOB00 = PRRTM00.NNYNOB AND CASE WHEN PRRTC00.BMNCD IS NOT NULL THEN PRRTC00.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM00.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC01 ON WK23_1.NNYNOB01 = PRRTC01.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC01.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC01.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM01 ON WK23_1.NNYNOB01 = PRRTM01.NNYNOB AND CASE WHEN PRRTC01.BMNCD IS NOT NULL THEN PRRTC01.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM01.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC02 ON WK23_1.NNYNOB02 = PRRTC02.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC02.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC02.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM02 ON WK23_1.NNYNOB02 = PRRTM02.NNYNOB AND CASE WHEN PRRTC02.BMNCD IS NOT NULL THEN PRRTC02.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM02.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC03 ON WK23_1.NNYNOB03 = PRRTC03.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC03.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC03.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM03 ON WK23_1.NNYNOB03 = PRRTM03.NNYNOB AND CASE WHEN PRRTC03.BMNCD IS NOT NULL THEN PRRTC03.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM03.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC04 ON WK23_1.NNYNOB04 = PRRTC04.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC04.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC04.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM04 ON WK23_1.NNYNOB04 = PRRTM04.NNYNOB AND CASE WHEN PRRTC04.BMNCD IS NOT NULL THEN PRRTC04.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM04.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC05 ON WK23_1.NNYNOB05 = PRRTC05.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC05.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC05.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM05 ON WK23_1.NNYNOB05 = PRRTM05.NNYNOB AND CASE WHEN PRRTC05.BMNCD IS NOT NULL THEN PRRTC05.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM05.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC06 ON WK23_1.NNYNOB06 = PRRTC06.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC06.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC06.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM06 ON WK23_1.NNYNOB06 = PRRTM06.NNYNOB AND CASE WHEN PRRTC06.BMNCD IS NOT NULL THEN PRRTC06.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM06.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC07 ON WK23_1.NNYNOB07 = PRRTC07.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC07.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC07.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM07 ON WK23_1.NNYNOB07 = PRRTM07.NNYNOB AND CASE WHEN PRRTC07.BMNCD IS NOT NULL THEN PRRTC07.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM07.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC08 ON WK23_1.NNYNOB08 = PRRTC08.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC08.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC08.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM08 ON WK23_1.NNYNOB08 = PRRTM08.NNYNOB AND CASE WHEN PRRTC08.BMNCD IS NOT NULL THEN PRRTC08.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM08.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC09 ON WK23_1.NNYNOB09 = PRRTC09.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC09.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC09.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM09 ON WK23_1.NNYNOB09 = PRRTM09.NNYNOB AND CASE WHEN PRRTC09.BMNCD IS NOT NULL THEN PRRTC09.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM09.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC10 ON WK23_1.NNYNOB10 = PRRTC10.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC10.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC10.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM10 ON WK23_1.NNYNOB10 = PRRTM10.NNYNOB AND CASE WHEN PRRTC10.BMNCD IS NOT NULL THEN PRRTC10.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM10.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTC11 ON WK23_1.NNYNOB11 = PRRTC11.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTC11.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTC11.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTM11 ON WK23_1.NNYNOB11 = PRRTM11.NNYNOB AND CASE WHEN PRRTC11.BMNCD IS NOT NULL THEN PRRTC11.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTM11.READTMPTN LEFT OUTER JOIN INAWK.D2WK_PRAM_READTMCNV PRRTCSH ON WK23_1.SETHACHBI = PRRTCSH.NNYNOB AND LEFT (SHN.SHNCD, 2) = PRRTCSH.BMNCD AND CASE WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTCSH.READTMPTN_BE LEFT OUTER JOIN INAWK.D2WK_PRAM_READTM PRRTMSH ON WK23_1.SETHACHBI = PRRTMSH.NNYNOB AND CASE WHEN PRRTCSH.BMNCD IS NOT NULL THEN PRRTCSH.READTMPTN_AF WHEN SHN.READTMPTN = 0 AND TBMN.TENCD IS NOT NULL THEN TBMN.READTMPTN ELSE SHN.READTMPTN END = PRRTMSH.READTMPTN) WK23_2 WHERE WK23_2.JIZNUT <> 2 AND WK23_2.SIDENF <> 1) SELECT BASE.REC_HAN_KBN, BASE.MISE, BASE.SHOHNC, BASE.FILLER01, BASE.SYOKBN, BASE.SETBINK, BASE.NOKAIS, BASE.NOSYUR, BASE.HAKAIS, BASE.HASYUR, BASE.NNYNOB, BASE.NONYB, BASE.HACHBI, BASE.HACYB, BASE.JZNGENKA, BASE.TUIGENKA, BASE.GENFU, BASE.GENFUK, BASE.A_SOBAIFG, BASE.B_SOBAIFG, BASE.C_SOBAIFG, BASE.A_SOBAIFP, BASE.B_SOBAIFP, BASE.C_SOBAIFP, BASE.A_SOBAIFK, BASE.B_SOBAIFK, BASE.C_SOBAIFK, BASE.A_BAIKA_SOTO, BASE.B_BAIKA_SOTO, BASE.C_BAIKA_SOTO, BASE.HEKINP, BASE.SETIRISU, BASE.BD1SU, BASE.BD2SU, BASE.A_BDBAIKA, BASE.A_BD1BAIKA, BASE.A_BD2BAIKA, BASE.B_BDBAIKA, BASE.B_BD1BAIKA, BASE.B_BD2BAIKA, BASE.C_BDBAIKA, BASE.C_BD1BAIKA, BASE.C_BD2BAIKA, BASE.SIIRCD, BASE.NENMAT, BASE.TEISEK, BASE.TRTEISEK, BASE.TTKBN, BASE.KZKBN, BASE.TEFTEI, BASE.BETUDEN, BASE.WAPENK, BASE.IKKATK, BASE.JIZNUT, BASE.SIDENF, BASE.TEICUTK, BASE.HOUZAI, BASE.DSEIK, BASE.PCKBN, BASE.HIGAWAK, BASE.HGEBATFL, BASE.REDMYFL, BASE.DATAK, BASE.SEISUR, BASE.HENSUR, BASE.SEITK, BASE.NONSJ, BASE.ATARA, BASE.RDHMHYO, BASE.RDHMMON, BASE.RDHMTUE, BASE.RDHMWED, BASE.RDHMTHU, BASE.RDHMFRI, BASE.RDHMSAT, BASE.RDHMSUN, BASE.NONSU, BASE.BUNBMC1, BASE.BUNDIC, BASE.BUNCHC, BASE.BUNSHC, BASE.BUNSSC, BASE.MSSIRE, BASE.MSIR, BASE.MSIKK, BASE.MSWAP, BASE.MSBIN, BASE.MOYOK, BASE.MOYOKA, BASE.MOYORE, BASE.BUNBMC2, BASE.KANBAN, BASE.EDABAN, BASE.SHUNO, BASE.SMISECD, BASE.KZCUT, BASE.KOUCUT, BASE.TEICUT, BASE.TOKCUT, BASE.KYUCUT, BASE.HACCUT, BASE.NONCUT, BASE.HSSCUT, BASE.ZERO, BASE.FILLER02, BASE.SYORIK, BASE.TOKCOME, BASE.KIKMKJ, BASE.SANTIMKJ, BASE.JIZNB, BASE.JZHCB, BASE.JZHCSUB, BASE.SIHCSYB, BASE.TTENRANK, BASE.HCUSU, BASE.BAISNKB, BASE.KZKUBETU, BASE.SYUFLG, BASE.HYSYUFLG, BASE.JZNLSKSKB, BASE.ANKUMUKB, BASE.FILLER03, BASE.SAKSEIB FROM BASE WHERE BASE.HACHBI = (SELECT SBD.DT_INT FROM INAPARM.SYSBATCHDT_HA SBD WHERE SBD.SMODE = 'DAILY');commit;
