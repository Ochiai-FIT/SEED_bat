SET SESSION aurora_parallel_query = ON;
INSERT IGNORE INTO INAWK.D2WK23_ZZQ102_Z WITH BASE AS (SELECT WK23_2.REC_HAN_KBN, WK23_2.MISE, WK23_2.SHOHNC, WK23_2.FILLER01, WK23_2.SYOKBN, WK23_2.SETBINK, WK23_2.NOKAIS, WK23_2.NOSYUR, WK23_2.HAKAIS, WK23_2.HASYUR, WK23_2.NNYNOB, WK23_2.NONYB, CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN WK23_2.SETHACHBI WHEN WK23_2.NNYNOB = NNYNOB11_H THEN WK23_2.NNYNOB11 WHEN WK23_2.NNYNOB = NNYNOB10_H THEN WK23_2.NNYNOB10 WHEN WK23_2.NNYNOB = NNYNOB09_H THEN WK23_2.NNYNOB09 WHEN WK23_2.NNYNOB = NNYNOB08_H THEN WK23_2.NNYNOB08 WHEN WK23_2.NNYNOB = NNYNOB07_H THEN WK23_2.NNYNOB07 WHEN WK23_2.NNYNOB = NNYNOB06_H THEN WK23_2.NNYNOB06 WHEN WK23_2.NNYNOB = NNYNOB05_H THEN WK23_2.NNYNOB05 WHEN WK23_2.NNYNOB = NNYNOB04_H THEN WK23_2.NNYNOB04 WHEN WK23_2.NNYNOB = NNYNOB03_H THEN WK23_2.NNYNOB03 WHEN WK23_2.NNYNOB = NNYNOB02_H THEN WK23_2.NNYNOB02 WHEN WK23_2.NNYNOB = NNYNOB01_H THEN WK23_2.NNYNOB01 WHEN WK23_2.NNYNOB = NNYNOB00_H THEN WK23_2.NNYNOB00 ELSE 0 END AS HACHBI, CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN WK23_2.SETHACYB WHEN WK23_2.NNYNOB = NNYNOB11_H THEN WK23_2.NNYNOWEK11 WHEN WK23_2.NNYNOB = NNYNOB10_H THEN WK23_2.NNYNOWEK10 WHEN WK23_2.NNYNOB = NNYNOB09_H THEN WK23_2.NNYNOWEK09 WHEN WK23_2.NNYNOB = NNYNOB08_H THEN WK23_2.NNYNOWEK08 WHEN WK23_2.NNYNOB = NNYNOB07_H THEN WK23_2.NNYNOWEK07 WHEN WK23_2.NNYNOB = NNYNOB06_H THEN WK23_2.NNYNOWEK06 WHEN WK23_2.NNYNOB = NNYNOB05_H THEN WK23_2.NNYNOWEK05 WHEN WK23_2.NNYNOB = NNYNOB04_H THEN WK23_2.NNYNOWEK04 WHEN WK23_2.NNYNOB = NNYNOB03_H THEN WK23_2.NNYNOWEK03 WHEN WK23_2.NNYNOB = NNYNOB02_H THEN WK23_2.NNYNOWEK02 WHEN WK23_2.NNYNOB = NNYNOB01_H THEN WK23_2.NNYNOWEK01 WHEN WK23_2.NNYNOB = NNYNOB00_H THEN WK23_2.NNYNOWEK00 ELSE 0 END AS HACYB, WK23_2.JZNGENKA, WK23_2.TUIGENKA, WK23_2.GENFU, WK23_2.GENFUK, WK23_2.A_SOBAIFG, WK23_2.B_SOBAIFG, WK23_2.C_SOBAIFG, WK23_2.A_SOBAIFP, WK23_2.B_SOBAIFP, WK23_2.C_SOBAIFP, WK23_2.A_SOBAIFK, WK23_2.B_SOBAIFK, WK23_2.C_SOBAIFK, WK23_2.A_BAIKA_SOTO, WK23_2.B_BAIKA_SOTO, WK23_2.C_BAIKA_SOTO, WK23_2.HEKINP, WK23_2.SETIRISU, WK23_2.BD1SU, WK23_2.BD2SU, WK23_2.A_BDBAIKA, WK23_2.A_BD1BAIKA, WK23_2.A_BD2BAIKA, WK23_2.B_BDBAIKA, WK23_2.B_BD1BAIKA, WK23_2.B_BD2BAIKA, WK23_2.C_BDBAIKA, WK23_2.C_BD1BAIKA, WK23_2.C_BD2BAIKA, WK23_2.SIIRCD, WK23_2.NENMAT, WK23_2.TEISEK, WK23_2.TRTEISEK, WK23_2.TTKBN, WK23_2.KZKBN, WK23_2.TEFTEI, WK23_2.BETUDEN, WK23_2.WAPENK, WK23_2.IKKATK, WK23_2.JIZNUT, WK23_2.SIDENF, WK23_2.TEICUTK, WK23_2.HOUZAI, WK23_2.DSEIK, WK23_2.PCKBN, WK23_2.HIGAWAK, WK23_2.HGEBATFL, WK23_2.REDMYFL, WK23_2.DATAK, WK23_2.SEISUR, WK23_2.HENSUR, WK23_2.SEITK, WK23_2.NONSJ, WK23_2.ATARA, WK23_2.RDHMHYO, CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_MONSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_MON11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_MON10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_MON09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_MON08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_MON07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_MON06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_MON05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_MON04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_MON03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_MON02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_MON01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_MON00 AS CHAR (1)) END AS RDHMMON, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_TUESH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_TUE11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_TUE10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_TUE09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_TUE08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_TUE07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_TUE06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_TUE05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_TUE04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_TUE03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_TUE02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_TUE01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_TUE00 AS CHAR (1)) END AS CHAR (1)) AS RDHMTUE, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_WEDSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_WED11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_WED10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_WED09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_WED08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_WED07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_WED06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_WED05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_WED04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_WED03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_WED02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_WED01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_WED00 AS CHAR (1)) END AS CHAR (1)) AS RDHMWED, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_THUSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_THU11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_THU10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_THU09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_THU08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_THU07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_THU06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_THU05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_THU04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_THU03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_THU02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_THU01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_THU00 AS CHAR (1)) END AS CHAR (1)) AS RDHMTHU, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_FRISH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_FRI11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_FRI10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_FRI09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_FRI08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_FRI07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_FRI06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_FRI05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_FRI04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_FRI03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_FRI02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_FRI01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_FRI00 AS CHAR (1)) END AS CHAR (1)) AS RDHMFRI, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_SATSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_SAT11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_SAT10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_SAT09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_SAT08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_SAT07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_SAT06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_SAT05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_SAT04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_SAT03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_SAT02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_SAT01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_SAT00 AS CHAR (1)) END AS CHAR (1)) AS RDHMSAT, CAST(CASE WHEN COALESCE(WK23_2.SETHACHBI, 0) <> 0 THEN CAST(WK23_2.READTM_SUNSH AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB11_H THEN CAST(WK23_2.READTM_SUN11 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB10_H THEN CAST(WK23_2.READTM_SUN10 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB09_H THEN CAST(WK23_2.READTM_SUN09 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB08_H THEN CAST(WK23_2.READTM_SUN08 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB07_H THEN CAST(WK23_2.READTM_SUN07 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB06_H THEN CAST(WK23_2.READTM_SUN06 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB05_H THEN CAST(WK23_2.READTM_SUN05 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB04_H THEN CAST(WK23_2.READTM_SUN04 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB03_H THEN CAST(WK23_2.READTM_SUN03 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB02_H THEN CAST(WK23_2.READTM_SUN02 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB01_H THEN CAST(WK23_2.READTM_SUN01 AS CHAR (1)) WHEN WK23_2.NNYNOB = NNYNOB00_H THEN CAST(WK23_2.READTM_SUN00 AS CHAR (1)) END AS CHAR (1)) AS RDHMSUN, WK23_2.NONSU, WK23_2.BUNBMC1, WK23_2.BUNDIC, WK23_2.BUNCHC, WK23_2.BUNSHC, WK23_2.BUNSSC, WK23_2.MSSIRE, WK23_2.MSIR, WK23_2.MSIKK, WK23_2.MSWAP, WK23_2.MSBIN, WK23_2.MOYOK, WK23_2.MOYOKA, WK23_2.MOYORE, WK23_2.BUNBMC2, WK23_2.KANBAN, WK23_2.EDABAN, WK23_2.SHUNO, WK23_2.SMISECD, WK23_2.KZCUT, WK23_2.KOUCUT, WK23_2.TEICUT, WK23_2.TOKCUT, WK23_2.KYUCUT, WK23_2.HACCUT, WK23_2.NONCUT, WK23_2.HSSCUT, WK23_2.ZERO, WK23_2.FILLER02, WK23_2.SYORIK, WK23_2.TOKCOME, WK23_2.KIKMKJ, WK23_2.SANTIMKJ, WK23_2.JIZNB, WK23_2.JZHCB, WK23_2.JZHCSUB, WK23_2.SIHCSYB, WK23_2.TTENRANK, WK23_2.HCUSU, WK23_2.BAISNKB, WK23_2.KZKUBETU, WK23_2.SYUFLG, WK23_2.HYSYUFLG, WK23_2.JZNLSKSKB, WK23_2.ANKUMUKB, WK23_2.FILLER03, WK23_2.SAKSEIB, WK23_2.ATSUK_STDT, WK23_2.ATSUK_EDDT, WK23_2.TEISHIKBN FROM INAWK.D2WK23_ZZQ102_Z_WK1 WK23_2 WHERE NOT EXISTS (SELECT 1 FROM INAMS2K.MSTTENKYU AIB06 WHERE AIB06.UPDKBN <> 1 AND AIB06.TENCD = WK23_2.MISE AND AIB06.TENKYUDT = WK23_2.NNYNOB) OR WK23_2.BMNKBN = 1 OR (WK23_2.BMNKBN = 2 AND WK23_2.MOYOK IN (8, 9))) SELECT BASE.REC_HAN_KBN, BASE.MISE, BASE.SHOHNC, BASE.FILLER01, BASE.SYOKBN, BASE.SETBINK, BASE.NOKAIS, BASE.NOSYUR, BASE.HAKAIS, BASE.HASYUR, BASE.NNYNOB, BASE.NONYB, BASE.HACHBI, BASE.HACYB, BASE.JZNGENKA, BASE.TUIGENKA, BASE.GENFU, BASE.GENFUK, BASE.A_SOBAIFG, BASE.B_SOBAIFG, BASE.C_SOBAIFG, BASE.A_SOBAIFP, BASE.B_SOBAIFP, BASE.C_SOBAIFP, BASE.A_SOBAIFK, BASE.B_SOBAIFK, BASE.C_SOBAIFK, BASE.A_BAIKA_SOTO, BASE.B_BAIKA_SOTO, BASE.C_BAIKA_SOTO, BASE.HEKINP, BASE.SETIRISU, BASE.BD1SU, BASE.BD2SU, BASE.A_BDBAIKA, BASE.A_BD1BAIKA, BASE.A_BD2BAIKA, BASE.B_BDBAIKA, BASE.B_BD1BAIKA, BASE.B_BD2BAIKA, BASE.C_BDBAIKA, BASE.C_BD1BAIKA, BASE.C_BD2BAIKA, BASE.SIIRCD, BASE.NENMAT, BASE.TEISEK, BASE.TRTEISEK, BASE.TTKBN, BASE.KZKBN, BASE.TEFTEI, BASE.BETUDEN, BASE.WAPENK, BASE.IKKATK, BASE.JIZNUT, BASE.SIDENF, BASE.TEICUTK, BASE.HOUZAI, BASE.DSEIK, BASE.PCKBN, BASE.HIGAWAK, BASE.HGEBATFL, BASE.REDMYFL, BASE.DATAK, BASE.SEISUR, BASE.HENSUR, BASE.SEITK, BASE.NONSJ, BASE.ATARA, BASE.RDHMHYO, BASE.RDHMMON, BASE.RDHMTUE, BASE.RDHMWED, BASE.RDHMTHU, BASE.RDHMFRI, BASE.RDHMSAT, BASE.RDHMSUN, BASE.NONSU, BASE.BUNBMC1, BASE.BUNDIC, BASE.BUNCHC, BASE.BUNSHC, BASE.BUNSSC, BASE.MSSIRE, BASE.MSIR, BASE.MSIKK, BASE.MSWAP, BASE.MSBIN, BASE.MOYOK, BASE.MOYOKA, BASE.MOYORE, BASE.BUNBMC2, BASE.KANBAN, BASE.EDABAN, BASE.SHUNO, BASE.SMISECD, BASE.KZCUT, BASE.KOUCUT, BASE.TEICUT, BASE.TOKCUT, BASE.KYUCUT, BASE.HACCUT, BASE.NONCUT, BASE.HSSCUT, BASE.ZERO, BASE.FILLER02, BASE.SYORIK, BASE.TOKCOME, BASE.KIKMKJ, BASE.SANTIMKJ, BASE.JIZNB, BASE.JZHCB, BASE.JZHCSUB, BASE.SIHCSYB, BASE.TTENRANK, BASE.HCUSU, BASE.BAISNKB, BASE.KZKUBETU, BASE.SYUFLG, BASE.HYSYUFLG, BASE.JZNLSKSKB, BASE.ANKUMUKB, BASE.FILLER03, BASE.SAKSEIB FROM BASE WHERE COALESCE(BASE.HACHBI, 0) <> 0 AND COALESCE(BASE.TEISHIKBN, 0) <> 1 AND ((COALESCE(BASE.ATSUK_STDT, 0) = 0 AND COALESCE(BASE.ATSUK_EDDT, 0) = 0) OR (COALESCE(BASE.ATSUK_STDT, 0) <= COALESCE(BASE.HACHBI, 0) AND COALESCE(BASE.ATSUK_EDDT, 0) >= COALESCE(BASE.HACHBI, 0)));
commit;
