INSERT IGNORE INTO INAWK.D2WK22_ZZQ102 WITH D3 AS (SELECT REC_HAN_KBN, MISE, SHOHNC, FILLER01, SYOKBN, BINK, NOKAIS, NOSYUR, HAKAIS, HASYUR, NNYNOB, NONYB, HACHBI, HACYB, JZNGENKA, TUIGENKA, GENFU, GENFUK, A_SOBAIFG, B_SOBAIFG, C_SOBAIFG, A_SOBAIFP, B_SOBAIFP, C_SOBAIFP, A_SOBAIFK, B_SOBAIFK, C_SOBAIFK, A_BAIKA_SOTO, B_BAIKA_SOTO, C_BAIKA_SOTO, HEKINP, MISIR, BD1SU, BD2SU, A_BDBAIKA, A_BD1BAIKA, A_BD2BAIKA, B_BDBAIKA, B_BD1BAIKA, B_BD2BAIKA, C_BDBAIKA, C_BD1BAIKA, C_BD2BAIKA, SIIRCD, NENMAT, TEISEK, TRTEISEK, TTKBN, KZKBN, TEFTEI, BETUDEN, WAPENK, IKKATK, JIZNUT, SIDENF, TEICUTK, HOUZAI, DSEIK, PCKBN, HIGAWAK, HGEBATFL, REDMYFL, DATAK, SEISUR, HENSUR, SEITK, NONSJ, ATARA, RDHMHYO, RDHMMON, RDHMTUE, RDHMWED, RDHMTHU, RDHMFRI, RDHMSAT, RDHMSUN, NONSU, BUNBMC1, BUNDIC, BUNCHC, BUNSHC, BUNSSC, MSSIRE, MSIR, MSIKK, MSWAP, MSBIN, MOYOK, MOYOKA, MOYORE, BUNBMC2, KANBAN, EDABAN, SHUNO, SMISECD, KZCUT, KOUCUT, TEICUT, TOKCUT, KYUCUT, HACCUT, NONCUT, HSSCUT, ZERO, FILLER02, SYORIK, TOKCOME, KIKMKJ, SANTIMKJ, JIZNB, JZHCB, JZHCSUB, SIHCSYB, TTENRANK, HCUSU, BAISNKB, KZKUBETU, SYUFLG, HYSYUFLG, JZNLSKSKB, ANKUMUKB, FILLER03, SAKSEIB FROM (SELECT T1.*, ROW_NUMBER() OVER (PARTITION BY T1.MISE, T1.SHOHNC, T1.NNYNOB ORDER BY T1.BINK DESC, T1.NOKAIS, T1.HAKAIS, T1.MOYOK, T1.MOYOKA, T1.MOYORE, T1.BUNBMC2, T1.KANBAN, T1.EDABAN) AS ODRNO FROM INAWK.D2WK20_ZZQ102 T1 WHERE T1.DWFLG = 'D' AND T1.DWFLG2 = 3) TIR WHERE ODRNO = 1), D1 AS (SELECT REC_HAN_KBN, MISE, SHOHNC, FILLER01, SYOKBN, BINK, NOKAIS, NOSYUR, HAKAIS, HASYUR, NNYNOB, NONYB, HACHBI, HACYB, JZNGENKA, TUIGENKA, GENFU, GENFUK, A_SOBAIFG, B_SOBAIFG, C_SOBAIFG, A_SOBAIFP, B_SOBAIFP, C_SOBAIFP, A_SOBAIFK, B_SOBAIFK, C_SOBAIFK, A_BAIKA_SOTO, B_BAIKA_SOTO, C_BAIKA_SOTO, HEKINP, MISIR, BD1SU, BD2SU, A_BDBAIKA, A_BD1BAIKA, A_BD2BAIKA, B_BDBAIKA, B_BD1BAIKA, B_BD2BAIKA, C_BDBAIKA, C_BD1BAIKA, C_BD2BAIKA, SIIRCD, NENMAT, TEISEK, TRTEISEK, TTKBN, KZKBN, TEFTEI, BETUDEN, WAPENK, IKKATK, JIZNUT, SIDENF, TEICUTK, HOUZAI, DSEIK, PCKBN, HIGAWAK, HGEBATFL, REDMYFL, DATAK, SEISUR, HENSUR, SEITK, NONSJ, ATARA, RDHMHYO, RDHMMON, RDHMTUE, RDHMWED, RDHMTHU, RDHMFRI, RDHMSAT, RDHMSUN, NONSU, BUNBMC1, BUNDIC, BUNCHC, BUNSHC, BUNSSC, MSSIRE, MSIR, MSIKK, MSWAP, MSBIN, MOYOK, MOYOKA, MOYORE, BUNBMC2, KANBAN, EDABAN, SHUNO, SMISECD, KZCUT, KOUCUT, TEICUT, TOKCUT, KYUCUT, HACCUT, NONCUT, HSSCUT, ZERO, FILLER02, SYORIK, TOKCOME, KIKMKJ, SANTIMKJ, JIZNB, JZHCB, JZHCSUB, SIHCSYB, TTENRANK, HCUSU, BAISNKB, KZKUBETU, SYUFLG, HYSYUFLG, JZNLSKSKB, ANKUMUKB, FILLER03, SAKSEIB FROM (SELECT T1.*, ROW_NUMBER() OVER (PARTITION BY T1.MISE, T1.SHOHNC, T1.NNYNOB ORDER BY T1.BINK DESC, T1.NOKAIS, T1.HAKAIS, T1.MOYOK, T1.MOYOKA, T1.MOYORE, T1.BUNBMC2, T1.KANBAN, T1.EDABAN) AS ODRNO FROM INAWK.D2WK20_ZZQ102 T1 WHERE T1.DWFLG = 'D' AND T1.DWFLG2 = 1) TIR WHERE ODRNO = 1 AND NOT EXISTS (SELECT 1 FROM D3 T1 WHERE T1.MISE = TIR.MISE AND T1.SHOHNC = TIR.SHOHNC AND T1.BINK = TIR.BINK AND T1.NNYNOB = TIR.NNYNOB)), D1_A AS (SELECT REC_HAN_KBN, MISE, SHOHNC, FILLER01, SYOKBN, BINK, NOKAIS, NOSYUR, HAKAIS, HASYUR, NNYNOB, NONYB, HACHBI, HACYB, JZNGENKA, TUIGENKA, GENFU, GENFUK, A_SOBAIFG, B_SOBAIFG, C_SOBAIFG, A_SOBAIFP, B_SOBAIFP, C_SOBAIFP, A_SOBAIFK, B_SOBAIFK, C_SOBAIFK, A_BAIKA_SOTO, B_BAIKA_SOTO, C_BAIKA_SOTO, HEKINP, MISIR, BD1SU, BD2SU, A_BDBAIKA, A_BD1BAIKA, A_BD2BAIKA, B_BDBAIKA, B_BD1BAIKA, B_BD2BAIKA, C_BDBAIKA, C_BD1BAIKA, C_BD2BAIKA, SIIRCD, NENMAT, TEISEK, TRTEISEK, TTKBN, KZKBN, TEFTEI, BETUDEN, WAPENK, IKKATK, JIZNUT, SIDENF, TEICUTK, HOUZAI, DSEIK, PCKBN, HIGAWAK, HGEBATFL, REDMYFL, DATAK, SEISUR, HENSUR, SEITK, NONSJ, ATARA, RDHMHYO, RDHMMON, RDHMTUE, RDHMWED, RDHMTHU, RDHMFRI, RDHMSAT, RDHMSUN, NONSU, BUNBMC1, BUNDIC, BUNCHC, BUNSHC, BUNSSC, MSSIRE, MSIR, MSIKK, MSWAP, MSBIN, MOYOK, MOYOKA, MOYORE, BUNBMC2, KANBAN, EDABAN, SHUNO, SMISECD, KZCUT, KOUCUT, TEICUT, TOKCUT, KYUCUT, HACCUT, NONCUT, HSSCUT, ZERO, FILLER02, SYORIK, TOKCOME, KIKMKJ, SANTIMKJ, JIZNB, JZHCB, JZHCSUB, SIHCSYB, TTENRANK, HCUSU, BAISNKB, KZKUBETU, SYUFLG, HYSYUFLG, JZNLSKSKB, ANKUMUKB, FILLER03, SAKSEIB FROM (SELECT T1.*, ROW_NUMBER() OVER (PARTITION BY T1.MISE, T1.SHOHNC, T1.NNYNOB ORDER BY T1.BINK DESC, T1.NOKAIS, T1.HAKAIS, T1.MOYOK, T1.MOYOKA, T1.MOYORE, T1.BUNBMC2, T1.KANBAN, T1.EDABAN) AS ODRNO FROM INAWK.D2WK20_ZZQ102 T1 WHERE T1.DWFLG = 'D' AND T1.DWFLG2 = 1) TIR WHERE ODRNO = 1), D49 AS (SELECT REC_HAN_KBN, MISE, SHOHNC, FILLER01, SYOKBN, BINK, NOKAIS, NOSYUR, HAKAIS, HASYUR, NNYNOB, NONYB, HACHBI, HACYB, JZNGENKA, TUIGENKA, GENFU, GENFUK, A_SOBAIFG, B_SOBAIFG, C_SOBAIFG, A_SOBAIFP, B_SOBAIFP, C_SOBAIFP, A_SOBAIFK, B_SOBAIFK, C_SOBAIFK, A_BAIKA_SOTO, B_BAIKA_SOTO, C_BAIKA_SOTO, HEKINP, MISIR, BD1SU, BD2SU, A_BDBAIKA, A_BD1BAIKA, A_BD2BAIKA, B_BDBAIKA, B_BD1BAIKA, B_BD2BAIKA, C_BDBAIKA, C_BD1BAIKA, C_BD2BAIKA, SIIRCD, NENMAT, TEISEK, TRTEISEK, TTKBN, KZKBN, TEFTEI, BETUDEN, WAPENK, IKKATK, JIZNUT, SIDENF, TEICUTK, HOUZAI, DSEIK, PCKBN, HIGAWAK, HGEBATFL, REDMYFL, DATAK, SEISUR, HENSUR, SEITK, NONSJ, ATARA, RDHMHYO, RDHMMON, RDHMTUE, RDHMWED, RDHMTHU, RDHMFRI, RDHMSAT, RDHMSUN, NONSU, BUNBMC1, BUNDIC, BUNCHC, BUNSHC, BUNSSC, MSSIRE, MSIR, MSIKK, MSWAP, MSBIN, MOYOK, MOYOKA, MOYORE, BUNBMC2, KANBAN, EDABAN, SHUNO, SMISECD, KZCUT, KOUCUT, TEICUT, TOKCUT, KYUCUT, HACCUT, NONCUT, HSSCUT, ZERO, FILLER02, SYORIK, TOKCOME, KIKMKJ, SANTIMKJ, JIZNB, JZHCB, JZHCSUB, SIHCSYB, TTENRANK, HCUSU, BAISNKB, KZKUBETU, SYUFLG, HYSYUFLG, JZNLSKSKB, ANKUMUKB, FILLER03, SAKSEIB FROM (SELECT T1.*, ROW_NUMBER() OVER (PARTITION BY T1.MISE, T1.SHOHNC, T1.NNYNOB ORDER BY T1.BINK DESC, T1.NOKAIS, T1.HAKAIS, T1.MOYOK, T1.MOYOKA, T1.MOYORE, T1.BUNBMC2, T1.KANBAN, T1.EDABAN) AS ODRNO FROM INAWK.D2WK20_ZZQ102 T1 WHERE T1.DWFLG = 'D' AND T1.DWFLG2 = 49) TIR WHERE ODRNO = 1 AND NOT EXISTS (SELECT 1 FROM D1_A T1 WHERE T1.MISE = TIR.MISE AND T1.SHOHNC = TIR.SHOHNC AND T1.BINK = TIR.BINK AND T1.NNYNOB = TIR.NNYNOB) AND NOT EXISTS (SELECT 1 FROM D3 T1 WHERE T1.MISE = TIR.MISE AND T1.SHOHNC = TIR.SHOHNC AND T1.BINK = TIR.BINK AND T1.NNYNOB = TIR.NNYNOB)) SELECT REC_HAN_KBN, MISE, SHOHNC, FILLER01, SYOKBN, BINK, NOKAIS, NOSYUR, HAKAIS, HASYUR, NNYNOB, NONYB, HACHBI, HACYB, JZNGENKA, TUIGENKA, GENFU, GENFUK, A_SOBAIFG, B_SOBAIFG, C_SOBAIFG, A_SOBAIFP, B_SOBAIFP, C_SOBAIFP, A_SOBAIFK, B_SOBAIFK, C_SOBAIFK, A_BAIKA_SOTO, B_BAIKA_SOTO, C_BAIKA_SOTO, HEKINP, MISIR, BD1SU, BD2SU, A_BDBAIKA, A_BD1BAIKA, A_BD2BAIKA, B_BDBAIKA, B_BD1BAIKA, B_BD2BAIKA, C_BDBAIKA, C_BD1BAIKA, C_BD2BAIKA, SIIRCD, NENMAT, TEISEK, TRTEISEK, TTKBN, KZKBN, TEFTEI, BETUDEN, WAPENK, IKKATK, JIZNUT, SIDENF, TEICUTK, HOUZAI, DSEIK, PCKBN, HIGAWAK, HGEBATFL, REDMYFL, DATAK, SEISUR, HENSUR, SEITK, NONSJ, ATARA, RDHMHYO, RDHMMON, RDHMTUE, RDHMWED, RDHMTHU, RDHMFRI, RDHMSAT, RDHMSUN, NONSU, BUNBMC1, BUNDIC, BUNCHC, BUNSHC, BUNSSC, MSSIRE, MSIR, MSIKK, MSWAP, MSBIN, MOYOK, MOYOKA, MOYORE, BUNBMC2, KANBAN, EDABAN, SHUNO, SMISECD, KZCUT, KOUCUT, TEICUT, TOKCUT, KYUCUT, HACCUT, NONCUT, HSSCUT, ZERO, FILLER02, SYORIK, TOKCOME, KIKMKJ, SANTIMKJ, JIZNB, JZHCB, JZHCSUB, SIHCSYB, TTENRANK, HCUSU, BAISNKB, KZKUBETU, SYUFLG, HYSYUFLG, JZNLSKSKB, ANKUMUKB, FILLER03, SAKSEIB, NULL AS DWFLG, NULL AS DWFLG2 FROM (SELECT * FROM D3 UNION ALL SELECT * FROM D1 UNION ALL SELECT * FROM D49) MS;commit;