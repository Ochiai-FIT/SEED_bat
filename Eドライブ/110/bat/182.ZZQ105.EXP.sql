SELECT LPAD(WK28.REC_HAN_KBN, 1, 0) || LPAD(WK28.MISE, 3, 0) || LPAD(WK28.MOYOK, 1, 0) || LPAD(WK28.MOYOKA, 6, 0) || LPAD(WK28.MOYORE, 3, 0) || LPAD(WK28.BUNBMC, 3, 0) || LPAD(WK28.KANBAN, 4, 0) || RPAD(WK28.SHOCD, 14, ' ') || RPAD(WK28.MAKRNMKJ, 14, 'Å@') || RPAD(WK28.SHOMKJ, 20, 'Å@') || RPAD(WK28.KIKMKJ, 23, 'Å@') || LPAD(WK28.MISIR, 3, 0) || LPAD(WK28.SAITEISU, 3, 0) || TRIM(LPAD(ROUND(WK28.GENKA * 100, 0), 8, 0)) || LPAD(WK28.A_SOBAIFG, 6, 0) || LPAD(WK28.B_SOBAIFG, 6, 0) || LPAD(WK28.C_SOBAIFG, 6, 0) || LPAD(WK28.A_RANK, 3, 0) || LPAD(WK28.B_RANK, 3, 0) || LPAD(WK28.C_RANK, 3, 0) || LPAD(WK28.POPCD, 10, 0) || RPAD(WK28.POPSIZE, 3, ' ') || LPAD(WK28.POPSU, 2, 0) || LPAD(WK28.MSF, 1, ' ') || LPAD(WK28.KOSINKB, 1, 0) || LPAD(WK28.SOSINFLG, 1, 0) || RPAD(WK28.OPERTO, 20, ' ') || LPAD(WK28.TOURKB, 8, 0) || LPAD(WK28.KOSINB, 8, 0) AS '1' FROM (SELECT CASE WHEN WK28T.MISE IS NOT NULL AND WK28Z.MISE IS NOT NULL THEN 2 WHEN WK28Z.MISE IS NULL THEN 1 ELSE 9 END AS REC_HAN_KBN, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MISE ELSE WK28Z.MISE END AS MISE, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MOYOK ELSE WK28Z.MOYOK END AS MOYOK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MOYOKA ELSE WK28Z.MOYOKA END AS MOYOKA, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MOYORE ELSE WK28Z.MOYORE END AS MOYORE, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.BUNBMC ELSE WK28Z.BUNBMC END AS BUNBMC, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KANBAN ELSE WK28Z.KANBAN END AS KANBAN, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SHOCD ELSE WK28Z.SHOCD END AS SHOCD, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MAKRNMKJ ELSE WK28Z.MAKRNMKJ END AS MAKRNMKJ, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SHOMKJ ELSE WK28Z.SHOMKJ END AS SHOMKJ, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KIKMKJ ELSE WK28Z.KIKMKJ END AS KIKMKJ, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MISIR ELSE WK28Z.MISIR END AS MISIR, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SAITEISU ELSE WK28Z.SAITEISU END AS SAITEISU, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.GENKA ELSE WK28Z.GENKA END AS GENKA, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.A_SOBAIFG ELSE WK28Z.A_SOBAIFG END AS A_SOBAIFG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.B_SOBAIFG ELSE WK28Z.B_SOBAIFG END AS B_SOBAIFG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.C_SOBAIFG ELSE WK28Z.C_SOBAIFG END AS C_SOBAIFG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.A_RANK ELSE WK28Z.A_RANK END AS A_RANK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.B_RANK ELSE WK28Z.B_RANK END AS B_RANK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.C_RANK ELSE WK28Z.C_RANK END AS C_RANK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.POPCD ELSE WK28Z.POPCD END AS POPCD, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.POPSIZE ELSE WK28Z.POPSIZE END AS POPSIZE, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.POPSU ELSE WK28Z.POPSU END AS POPSU, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MSF ELSE WK28Z.MSF END AS MSF, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KOSINKB ELSE WK28Z.KOSINKB END AS KOSINKB, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SOSINFLG ELSE WK28Z.SOSINFLG END AS SOSINFLG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.OPERTO ELSE WK28Z.OPERTO END AS OPERTO, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.TOURKB ELSE WK28Z.TOURKB END AS TOURKB, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KOSINB ELSE WK28Z.KOSINB END AS KOSINB, WK28T.SOSINFLG AS SOSINFLG_T FROM INAWK.D2WK28_ZZQ113_3 WK28T LEFT OUTER JOIN INAPRE.D2WK28_ZZQ113_3 WK28Z ON WK28T.MISE = WK28Z.MISE AND WK28T.MOYOK = WK28Z.MOYOK AND WK28T.MOYOKA = WK28Z.MOYOKA AND WK28T.MOYORE = WK28Z.MOYORE AND WK28T.BUNBMC = WK28Z.BUNBMC AND WK28T.KANBAN = WK28Z.KANBAN AND WK28T.SHOCD = WK28Z.SHOCD UNION ALL SELECT CASE WHEN WK28T.MISE IS NOT NULL AND WK28Z.MISE IS NOT NULL THEN 2 WHEN WK28Z.MISE IS NULL THEN 1 ELSE 9 END AS REC_HAN_KBN, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MISE ELSE WK28Z.MISE END AS MISE, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MOYOK ELSE WK28Z.MOYOK END AS MOYOK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MOYOKA ELSE WK28Z.MOYOKA END AS MOYOKA, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MOYORE ELSE WK28Z.MOYORE END AS MOYORE, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.BUNBMC ELSE WK28Z.BUNBMC END AS BUNBMC, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KANBAN ELSE WK28Z.KANBAN END AS KANBAN, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SHOCD ELSE WK28Z.SHOCD END AS SHOCD, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MAKRNMKJ ELSE WK28Z.MAKRNMKJ END AS MAKRNMKJ, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SHOMKJ ELSE WK28Z.SHOMKJ END AS SHOMKJ, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KIKMKJ ELSE WK28Z.KIKMKJ END AS KIKMKJ, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MISIR ELSE WK28Z.MISIR END AS MISIR, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SAITEISU ELSE WK28Z.SAITEISU END AS SAITEISU, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.GENKA ELSE WK28Z.GENKA END AS GENKA, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.A_SOBAIFG ELSE WK28Z.A_SOBAIFG END AS A_SOBAIFG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.B_SOBAIFG ELSE WK28Z.B_SOBAIFG END AS B_SOBAIFG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.C_SOBAIFG ELSE WK28Z.C_SOBAIFG END AS C_SOBAIFG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.A_RANK ELSE WK28Z.A_RANK END AS A_RANK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.B_RANK ELSE WK28Z.B_RANK END AS B_RANK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.C_RANK ELSE WK28Z.C_RANK END AS C_RANK, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.POPCD ELSE WK28Z.POPCD END AS POPCD, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.POPSIZE ELSE WK28Z.POPSIZE END AS POPSIZE, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.POPSU ELSE WK28Z.POPSU END AS POPSU, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.MSF ELSE WK28Z.MSF END AS MSF, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KOSINKB ELSE WK28Z.KOSINKB END AS KOSINKB, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.SOSINFLG ELSE WK28Z.SOSINFLG END AS SOSINFLG, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.OPERTO ELSE WK28Z.OPERTO END AS OPERTO, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.TOURKB ELSE WK28Z.TOURKB END AS TOURKB, CASE WHEN WK28T.MISE IS NOT NULL THEN WK28T.KOSINB ELSE WK28Z.KOSINB END AS KOSINB, WK28T.SOSINFLG AS SOSINFLG_T FROM INAWK.D2WK28_ZZQ113_3 WK28T RIGHT OUTER JOIN INAPRE.D2WK28_ZZQ113_3 WK28Z ON WK28T.MISE = WK28Z.MISE AND WK28T.MOYOK = WK28Z.MOYOK AND WK28T.MOYOKA = WK28Z.MOYOKA AND WK28T.MOYORE = WK28Z.MOYORE AND WK28T.BUNBMC = WK28Z.BUNBMC AND WK28T.KANBAN = WK28Z.KANBAN AND WK28T.SHOCD = WK28Z.SHOCD WHERE WK28T.MISE IS NULL AND WK28T.MOYOK IS NULL AND WK28T.MOYOKA IS NULL AND WK28T.MOYORE IS NULL AND WK28T.BUNBMC IS NULL AND WK28T.KANBAN IS NULL AND WK28T.SHOCD IS NULL) WK28 WHERE (WK28.REC_HAN_KBN = 1) OR (WK28.REC_HAN_KBN = 9) OR (WK28.REC_HAN_KBN = 2 AND NOT EXISTS (SELECT * FROM INAPRE.D2WK28_ZZQ113_3 Z WHERE WK28.MISE = Z.MISE AND WK28.MOYOK = Z.MOYOK AND WK28.MOYOKA = Z.MOYOKA AND WK28.MOYORE = Z.MOYORE AND WK28.BUNBMC = Z.BUNBMC AND WK28.KANBAN = Z.KANBAN AND WK28.SHOCD = Z.SHOCD AND WK28.MAKRNMKJ = Z.MAKRNMKJ AND WK28.SHOMKJ = Z.SHOMKJ AND WK28.KIKMKJ = Z.KIKMKJ AND WK28.MISIR = Z.MISIR AND WK28.SAITEISU = Z.SAITEISU AND WK28.GENKA = Z.GENKA AND WK28.A_SOBAIFG = Z.A_SOBAIFG AND WK28.B_SOBAIFG = Z.B_SOBAIFG AND WK28.C_SOBAIFG = Z.C_SOBAIFG AND WK28.A_RANK = Z.A_RANK AND WK28.B_RANK = Z.B_RANK AND WK28.C_RANK = Z.C_RANK AND WK28.POPCD = Z.POPCD AND WK28.POPSIZE = Z.POPSIZE AND WK28.POPSU = Z.POPSU AND WK28.MSF = Z.MSF AND WK28.KOSINKB = Z.KOSINKB AND WK28.OPERTO = Z.OPERTO AND WK28.TOURKB = Z.TOURKB AND WK28.KOSINB = Z.KOSINB)) OR (WK28.REC_HAN_KBN = 2 AND WK28.SOSINFLG_T IN (0, 9) AND NOT EXISTS (SELECT * FROM INAPRE.D2WK28_ZZQ113_3 Z WHERE WK28.MISE = Z.MISE AND WK28.MOYOK = Z.MOYOK AND WK28.MOYOKA = Z.MOYOKA AND WK28.MOYORE = Z.MOYORE AND WK28.BUNBMC = Z.BUNBMC AND WK28.KANBAN = Z.KANBAN AND WK28.SHOCD = Z.SHOCD AND WK28.MAKRNMKJ = Z.MAKRNMKJ AND WK28.SHOMKJ = Z.SHOMKJ AND WK28.KIKMKJ = Z.KIKMKJ AND WK28.MISIR = Z.MISIR AND WK28.SAITEISU = Z.SAITEISU AND WK28.GENKA = Z.GENKA AND WK28.A_SOBAIFG = Z.A_SOBAIFG AND WK28.B_SOBAIFG = Z.B_SOBAIFG AND WK28.C_SOBAIFG = Z.C_SOBAIFG AND WK28.A_RANK = Z.A_RANK AND WK28.B_RANK = Z.B_RANK AND WK28.C_RANK = Z.C_RANK AND WK28.POPCD = Z.POPCD AND WK28.POPSIZE = Z.POPSIZE AND WK28.POPSU = Z.POPSU AND WK28.MSF = Z.MSF AND WK28.KOSINKB = Z.KOSINKB AND WK28.SOSINFLG = Z.SOSINFLG AND WK28.OPERTO = Z.OPERTO AND WK28.TOURKB = Z.TOURKB AND WK28.KOSINB = Z.KOSINB)) ORDER BY WK28.MISE, WK28.MOYOK, WK28.MOYOKA, WK28.MOYORE, WK28.BUNBMC, WK28.KANBAN, WK28.SHOCD;
