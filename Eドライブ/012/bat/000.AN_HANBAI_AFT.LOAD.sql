INSERT IGNORE INTO INAIF.AN_HANBAI_AFT WITH TDATE as (SELECT * FROM INAPARM.SYSBATCHDT_TK SBD WHERE SBD.ACTIVEFLG = 1 AND SBD.SMODE = 'DAILY') SELECT WK08.MOYSCD, WK08.MOYSKBN, WK08.MOYSSTDT, WK08.MOYSRBAN, WK08.BMNCD, WK08.KANRINO, WK08.KANRIENO, WK08.TENCD, WK08.BMNO, WK08.MOHBSTDT, WK08.MOHBEDDT, WK08.HBOKUREFLG, WK08.JLSTCREDT, WK08.QADEVSTDT, WK08.QADEVENDFLG, WK08.TENGPCD, WK08.KYOSEIFLG, WK08.SHNCD, WK08.ADDSHUKBN, WK08.HBSTDT, WK08.HBEDDT, WK08.REIDMYKBN, WK08.HBSLIDE, WK08.GENKAAM, WK08.GENKARITU, WK08.A_BAIKAAM, WK08.B_BAIKAAM, WK08.C_BAIKAAM, WK08.A_GENKAAM_1KG, WK08.B_GENKAAM_1KG, WK08.C_GENKAAM_1KG, WK08.A_WRITUKBN, WK08.B_WRITUKBN, WK08.C_WRITUKBN, WK08.TKANPLUKBN, WK08.KO_A_BAIKAAN, WK08.BD1_A_BAIKAAN, WK08.BD2_A_BAIKAAN, WK08.KO_B_BAIKAAN, WK08.BD1_B_BAIKAAN, WK08.BD2_B_BAIKAAN, WK08.KO_C_BAIKAAN, WK08.BD1_C_BAIKAAN, WK08.BD2_C_BAIKAAN, WK08.PLUSNDFLG, WK08.TEIKEIKBN, WK08.SOURCEKBN1, WK08.SRCCD1, WK08.SOURCEKBN2, WK08.SRCCD2, WK08.URICD, WK08.QASYUKBN, WK08.LTENSAIFLG, WK08.HBSTRTFLG, WK08.TENSAIFLG, WK08.URIASELKBN, WK08.ITMSELKBN, WK08.CBAIKA, WK08.SBAIBL1, WK08.SBAIBL2, CASE WHEN L221_BAIKA_EDIT3 = 1 AND WK08.ADDSHUKBN in (4, 5) AND WK08.TKANPLUKBN = 2 THEN CASE WHEN WK08.URIASELKBN = 1 THEN WK08.A_GENKAAM_1KG ELSE WK08.CBAIKA * 10 END ELSE WK08.CBAIKAKG END AS CBAIKAKG, WK08.DATAKBN, WK08.GTSIMECHGKBN, WK08.GTSIMEOKFLG, WK08.SENDFLG, WK08.UPDKBN FROM (SELECT WK08.MOYSCD, WK08.MOYSKBN, WK08.MOYSSTDT, WK08.MOYSRBAN, WK08.BMNO, WK08.MOHBSTDT, WK08.MOHBEDDT, WK08.HBOKUREFLG, WK08.JLSTCREDT, WK08.QADEVSTDT, WK08.QADEVENDFLG, WK08.TENGPCD, WK08.KYOSEIFLG, WK08.KANRINO, WK08.KANRIENO, WK08.BMNCD, WK08.SHNCD, WK08.ADDSHUKBN, WK08.HBSTDT, WK08.HBEDDT, WK08.REIDMYKBN, WK08.HBSLIDE, WK08.GENKAAM, WK08.GENKARITU, WK08.A_BAIKAAM, WK08.B_BAIKAAM, WK08.C_BAIKAAM, WK08.A_GENKAAM_1KG, WK08.B_GENKAAM_1KG, WK08.C_GENKAAM_1KG, WK08.A_WRITUKBN, WK08.B_WRITUKBN, WK08.C_WRITUKBN, WK08.TKANPLUKBN, WK08.KO_A_BAIKAAN, WK08.BD1_A_BAIKAAN, WK08.BD2_A_BAIKAAN, WK08.KO_B_BAIKAAN, WK08.BD1_B_BAIKAAN, WK08.BD2_B_BAIKAAN, WK08.KO_C_BAIKAAN, WK08.BD1_C_BAIKAAN, WK08.BD2_C_BAIKAAN, WK08.PLUSNDFLG, WK08.TEIKEIKBN, WK08.SOURCEKBN1, WK08.SRCCD1, WK08.SOURCEKBN2, WK08.SRCCD2, WK08.URICD, WK08.TENCD, WK08.QASYUKBN, WK08.LTENSAIFLG, WK08.HBSTRTFLG, WK08.TENSAIFLG, CASE WHEN L221_BAIKA_EDIT1 = 1 THEN CASE WHEN WK08.URIASELKBN = 1 THEN WK08.URIASELKBN WHEN WK08.URIASELKBN = 2 THEN CASE WHEN WK08.B_BAIKAAM <> 0 THEN WK08.URIASELKBN ELSE 1 END WHEN WK08.URIASELKBN = 3 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN WK08.URIASELKBN WHEN WK08.B_BAIKAAM <> 0 THEN 2 ELSE 1 END END WHEN L221_BAIKA_EDIT1_R = 1 THEN CASE WHEN WK08.URIASELKBN = 1 THEN WK08.URIASELKBN WHEN WK08.URIASELKBN = 2 THEN CASE WHEN WK08.B_WRITUKBN <> 0 THEN WK08.URIASELKBN ELSE 1 END WHEN WK08.URIASELKBN = 3 THEN CASE WHEN WK08.C_WRITUKBN <> 0 THEN WK08.URIASELKBN WHEN WK08.B_WRITUKBN <> 0 THEN 2 ELSE 1 END END WHEN L221_BAIKA_EDIT2 = 1 AND WK08.ADDSHUKBN <> 3 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN 3 WHEN WK08.B_BAIKAAM <> 0 THEN 2 ELSE 1 END WHEN L221_BAIKA_EDIT2_R = 1 AND WK08.ADDSHUKBN <> 3 THEN CASE WHEN WK08.C_WRITUKBN <> 0 THEN 3 WHEN WK08.B_WRITUKBN <> 0 THEN 2 ELSE 1 END ELSE WK08.URIASELKBN END as URIASELKBN, WK08.ITMSELKBN, CASE WHEN L221_BAIKA_EDIT1 = 1 THEN CASE WHEN WK08.URIASELKBN = 1 THEN CASE WHEN WK08.KO_A_BAIKAAN <> 0 THEN WK08.KO_A_BAIKAAN ELSE WK08.A_BAIKAAM END WHEN WK08.URIASELKBN = 2 THEN CASE WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.KO_B_BAIKAAN <> 0 THEN WK08.KO_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.KO_A_BAIKAAN <> 0 THEN WK08.KO_A_BAIKAAN ELSE WK08.A_BAIKAAM END END WHEN WK08.URIASELKBN = 3 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN CASE WHEN WK08.KO_C_BAIKAAN <> 0 THEN WK08.KO_C_BAIKAAN ELSE WK08.C_BAIKAAM END WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.KO_B_BAIKAAN <> 0 THEN WK08.KO_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.KO_A_BAIKAAN <> 0 THEN WK08.KO_A_BAIKAAN ELSE WK08.A_BAIKAAM END END ELSE WK08.CBAIKA END WHEN L221_BAIKA_EDIT1_R = 1 THEN CASE WHEN WK08.URIASELKBN = 1 THEN WK08.A_WRITUKBN WHEN WK08.URIASELKBN = 2 THEN CASE WHEN WK08.B_WRITUKBN <> 0 THEN WK08.B_WRITUKBN ELSE WK08.A_WRITUKBN END WHEN WK08.URIASELKBN = 3 THEN CASE WHEN WK08.C_WRITUKBN <> 0 THEN WK08.C_WRITUKBN WHEN WK08.B_WRITUKBN <> 0 THEN WK08.B_WRITUKBN ELSE WK08.A_WRITUKBN END ELSE WK08.CBAIKA END WHEN L221_BAIKA_EDIT2 = 1 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN CASE WHEN WK08.KO_C_BAIKAAN <> 0 THEN WK08.KO_C_BAIKAAN ELSE WK08.C_BAIKAAM END WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.KO_B_BAIKAAN <> 0 THEN WK08.KO_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.KO_A_BAIKAAN <> 0 THEN WK08.KO_A_BAIKAAN ELSE WK08.A_BAIKAAM END END WHEN L221_BAIKA_EDIT2_R = 1 THEN CASE WHEN WK08.C_WRITUKBN <> 0 THEN WK08.C_WRITUKBN WHEN WK08.B_WRITUKBN <> 0 THEN WK08.B_WRITUKBN ELSE WK08.A_WRITUKBN END WHEN L221_BAIKA_EDIT4 = 1 THEN CASE WHEN WK08.ADDSHUKBN = 1 THEN CASE WHEN WK08.URICHGAM1 <> 0 AND WK08.URICHGAM1 in (WK08.A_WRITUKBN, WK08.B_WRITUKBN, WK08.C_WRITUKBN) THEN WK08.URICHGAM1 WHEN WK08.C_WRITUKBN <> 0 THEN WK08.C_WRITUKBN WHEN WK08.B_WRITUKBN <> 0 THEN WK08.B_WRITUKBN ELSE WK08.A_WRITUKBN END ELSE CASE WHEN WK08.URIASELKBN_SHN = '1' OR WK08.B_BAIKAAM = 0 THEN CASE WHEN WK08.KO_A_BAIKAAN <> 0 THEN WK08.KO_A_BAIKAAN ELSE WK08.A_BAIKAAM END ELSE WK08.URICHGAM1 END END ELSE WK08.CBAIKA END AS CBAIKA, CASE WHEN L221_BAIKA_EDIT1 = 1 THEN CASE WHEN WK08.URIASELKBN = 1 THEN CASE WHEN WK08.BD1_A_BAIKAAN <> 0 THEN WK08.BD1_A_BAIKAAN ELSE WK08.A_BAIKAAM END WHEN WK08.URIASELKBN = 2 THEN CASE WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.BD1_B_BAIKAAN <> 0 THEN WK08.BD1_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.BD1_A_BAIKAAN <> 0 THEN WK08.BD1_A_BAIKAAN ELSE WK08.A_BAIKAAM END END WHEN WK08.URIASELKBN = 3 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN CASE WHEN WK08.BD1_C_BAIKAAN <> 0 THEN WK08.BD1_C_BAIKAAN ELSE WK08.C_BAIKAAM END WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.BD1_B_BAIKAAN <> 0 THEN WK08.BD1_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.BD1_A_BAIKAAN <> 0 THEN WK08.BD1_A_BAIKAAN ELSE WK08.A_BAIKAAM END END ELSE WK08.SBAIBL1 END WHEN L221_BAIKA_EDIT2 = 1 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN CASE WHEN WK08.BD1_C_BAIKAAN <> 0 THEN WK08.BD1_C_BAIKAAN ELSE WK08.C_BAIKAAM END WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.BD1_B_BAIKAAN <> 0 THEN WK08.BD1_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.BD1_A_BAIKAAN <> 0 THEN WK08.BD1_A_BAIKAAN ELSE WK08.A_BAIKAAM END END WHEN L221_BAIKA_EDIT4 = 1 THEN CASE WHEN WK08.ADDSHUKBN <> 1 THEN CASE WHEN WK08.URIASELKBN_SHN = '1' OR WK08.B_BAIKAAM = 0 THEN CASE WHEN WK08.KO_A_BAIKAAN <> 0 THEN WK08.BD1_A_BAIKAAN ELSE WK08.SBAIBL1 END ELSE WK08.URICHGAM2 END ELSE WK08.SBAIBL1 END ELSE WK08.SBAIBL1 END AS SBAIBL1, CASE WHEN L221_BAIKA_EDIT1 = 1 THEN CASE WHEN WK08.URIASELKBN = 1 THEN CASE WHEN WK08.BD2_A_BAIKAAN <> 0 THEN WK08.BD2_A_BAIKAAN ELSE WK08.A_BAIKAAM END WHEN WK08.URIASELKBN = 2 THEN CASE WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.BD2_B_BAIKAAN <> 0 THEN WK08.BD2_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.BD2_A_BAIKAAN <> 0 THEN WK08.BD2_A_BAIKAAN ELSE WK08.A_BAIKAAM END END WHEN WK08.URIASELKBN = 3 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN CASE WHEN WK08.BD2_C_BAIKAAN <> 0 THEN WK08.BD2_C_BAIKAAN ELSE WK08.C_BAIKAAM END WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.BD2_B_BAIKAAN <> 0 THEN WK08.BD2_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.BD2_A_BAIKAAN <> 0 THEN WK08.BD2_A_BAIKAAN ELSE WK08.A_BAIKAAM END END ELSE WK08.SBAIBL2 END WHEN L221_BAIKA_EDIT2 = 1 THEN CASE WHEN WK08.C_BAIKAAM <> 0 THEN CASE WHEN WK08.BD2_C_BAIKAAN <> 0 THEN WK08.BD2_C_BAIKAAN ELSE WK08.C_BAIKAAM END WHEN WK08.B_BAIKAAM <> 0 THEN CASE WHEN WK08.BD2_B_BAIKAAN <> 0 THEN WK08.BD2_B_BAIKAAN ELSE WK08.B_BAIKAAM END ELSE CASE WHEN WK08.BD2_A_BAIKAAN <> 0 THEN WK08.BD2_A_BAIKAAN ELSE WK08.A_BAIKAAM END END WHEN L221_BAIKA_EDIT4 = 1 THEN CASE WHEN WK08.ADDSHUKBN <> 1 THEN CASE WHEN WK08.URIASELKBN_SHN = '1' OR WK08.B_BAIKAAM = 0 THEN CASE WHEN WK08.KO_A_BAIKAAN <> 0 THEN WK08.BD2_A_BAIKAAN ELSE WK08.SBAIBL2 END ELSE WK08.URICHGAM3 END ELSE WK08.SBAIBL2 END ELSE WK08.SBAIBL2 END AS SBAIBL2, WK08.CBAIKAKG, WK08.DATAKBN, WK08.GTSIMECHGKBN, WK08.GTSIMEOKFLG, WK08.SENDFLG, WK08.UPDKBN, WK08.L221_BAIKA_EDIT3 FROM (SELECT WK01.MOYSCD, WK01.MOYSKBN, WK01.MOYSSTDT, WK01.MOYSRBAN, WK01.BMNO, WK01.MOHBSTDT, WK01.MOHBEDDT, WK01.HBOKUREFLG, WK01.JLSTCREDT, WK01.QADEVSTDT, WK01.QADEVENDFLG, WK01.TENGPCD, WK01.KYOSEIFLG, WK01.KANRINO, WK01.KANRIENO, WK01.BMNCD, WK01.SHNCD, WK01.ADDSHUKBN, WK01.HBSTDT, WK01.HBEDDT, WK01.REIDMYKBN, WK01.HBSLIDEFLG AS HBSLIDE, WK01.GENKAAM, WK01.GENKARITU, WK01.A_BAIKAAM, WK01.B_BAIKAAM, WK01.C_BAIKAAM, WK01.A_GENKAAM_1KG, WK01.B_GENKAAM_1KG, WK01.C_GENKAAM_1KG, WK01.A_WRITUKBN, WK01.B_WRITUKBN, WK01.C_WRITUKBN, WK01.TKANPLUKBN, WK01.KO_A_BAIKAAN, WK01.BD1_A_BAIKAAN, WK01.BD2_A_BAIKAAN, WK01.KO_B_BAIKAAN, WK01.BD1_B_BAIKAAN, WK01.BD2_B_BAIKAAN, WK01.KO_C_BAIKAAN, WK01.BD1_C_BAIKAAN, WK01.BD2_C_BAIKAAN, WK01.PLUSNDFLG, WK01.TEIKEIKBN, WK01.SOURCEKBN1, WK01.SRCCD1, WK01.SOURCEKBN2, WK01.SRCCD2, WK01.URICD, WK01.TENCD, WK01.QASYUKBN, CASE WHEN QAGP.MOYSKBN IS NOT NULL THEN QAGP.LDSYFLG ELSE WK01.LTENSAIFLG END AS LTENSAIFLG, CASE WHEN QATEN.MOYSKBN IS NOT NULL THEN QATEN.HBSTRTFLG ELSE WK01.HANKAISIFLG END AS HBSTRTFLG, CASE WHEN QATEN.MOYSKBN IS NOT NULL THEN CASE WHEN QATEN.LDTENKBN = 0 THEN CASE WHEN QATEN.MBSYFLG = 1 THEN 1 WHEN QATEN.MBSYFLG = 2 THEN 0 END WHEN QATEN.LDTENKBN = 1 THEN CASE WHEN QATEN.MBSYFLG = 1 THEN 2 WHEN QATEN.MBSYFLG = 2 THEN 3 END END ELSE WK01.TENSAIFLG END AS TENSAIFLG, CASE WHEN QASHN.MOYSKBN IS NOT NULL AND QAGP.QASYUKBN = 2 THEN QASHN.URISELKBN WHEN QAGP.MOYSKBN IS NOT NULL THEN CASE WHEN QAGP.QASYUKBN IN (1, 4) THEN QAGP.URIASELKBN WHEN QAGP.QASYUKBN = 3 THEN 4 END ELSE WK01.URIASELKBN END AS URIASELKBN, CASE WHEN QASHN.MOYSKBN IS NOT NULL AND WK01.QASYUKBN = 4 THEN CASE WHEN QASHN.ITMSELKBN = 0 THEN 2 ELSE 1 END ELSE WK01.ITMSELKBN END AS ITMSELKBN, WK01.CBAIKA, WK01.SBAIBL1, WK01.SBAIBL2, WK01.CBAIKAKG, WK01.DATAKBN, WK01.GTSIMECHGKBN, WK01.GTSIMEOKFLG, WK01.SENDFLG, WK01.UPDKBN, QASHN.MOYSKBN AS MOYSKBN_SHN, LEFT (QASHN.OPERATOR, 14) AS SHNCD_SHN, SUBSTR(QASHN.OPERATOR, 15, 1) AS URIASELKBN_SHN, QASHN.URICHGAM1, QASHN.URICHGAM2, QASHN.URICHGAM3, CASE WHEN QASHN.MOYSKBN IS NULL AND WK01.ADDSHUKBN = 1 AND WK01.QASYUKBN in (1, 4) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN = 1 AND LEFT (QASHN.OPERATOR, 14) <> WK01.SHNCD AND WK01.QASYUKBN in (1, 4) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN = 1 AND LEFT (QASHN.OPERATOR, 14) = WK01.SHNCD AND WK01.QASYUKBN in (1, 2, 4) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO = WK01.KANRIENO AND WK01.QASYUKBN in (1, 2, 4) AND WK01.ADDSHUKBN = 1 THEN 1 ELSE 0 END as L221_BAIKA_EDIT1_R, CASE WHEN QASHN.MOYSKBN IS NULL AND WK01.ADDSHUKBN = 1 AND WK01.QASYUKBN in (2, 3) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN = 1 AND LEFT (QASHN.OPERATOR, 14) <> WK01.SHNCD AND WK01.QASYUKBN in (2, 3) THEN 1 ELSE 0 END as L221_BAIKA_EDIT2_R, CASE WHEN QASHN.MOYSKBN IS NULL AND WK01.ADDSHUKBN <> 1 AND WK01.QASYUKBN in (1, 4) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN <> 1 AND LEFT (QASHN.OPERATOR, 14) <> WK01.SHNCD AND WK01.QASYUKBN in (1, 4) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN <> 1 AND LEFT (QASHN.OPERATOR, 14) = WK01.SHNCD AND WK01.QASYUKBN in (1, 2, 4) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO = WK01.KANRIENO AND WK01.QASYUKBN in (1, 2, 4) AND WK01.ADDSHUKBN <> 1 THEN 1 ELSE 0 END as L221_BAIKA_EDIT1, CASE WHEN QASHN.MOYSKBN IS NULL AND WK01.ADDSHUKBN <> 1 AND WK01.QASYUKBN in (2, 3) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN <> 1 AND LEFT (QASHN.OPERATOR, 14) <> WK01.SHNCD AND WK01.QASYUKBN in (2, 3) THEN 1 ELSE 0 END as L221_BAIKA_EDIT2, CASE WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN <> 1 AND LEFT (QASHN.OPERATOR, 14) = WK01.SHNCD AND WK01.QASYUKBN in (3) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO = WK01.KANRIENO AND WK01.QASYUKBN in (3) THEN 1 ELSE 0 END as L221_BAIKA_EDIT3, CASE WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN = 1 AND LEFT (QASHN.OPERATOR, 14) = WK01.SHNCD AND WK01.QASYUKBN in (3) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO <> WK01.KANRIENO AND WK01.ADDSHUKBN <> 1 AND LEFT (QASHN.OPERATOR, 14) = WK01.SHNCD AND WK01.QASYUKBN in (3) THEN 1 WHEN QASHN.MOYSKBN IS NOT NULL AND QASHN.KANRIENO = WK01.KANRIENO AND WK01.QASYUKBN in (3) THEN 1 ELSE 0 END as L221_BAIKA_EDIT4 FROM INAIF.AN_HANBAI_BFR WK01 INNER JOIN TDATE TD on WK01.QADEVSTDT <= TD.DT_INT LEFT OUTER JOIN INATK2.TOKTG_QATEN QATEN ON WK01.MOYSKBN = QATEN.MOYSKBN AND WK01.MOYSSTDT = QATEN.MOYSSTDT AND WK01.MOYSRBAN = QATEN.MOYSRBAN AND WK01.TENGPCD = QATEN.TENGPCD AND WK01.TENCD = QATEN.TENCD LEFT OUTER JOIN INATK2.TOKTG_QAGP QAGP ON WK01.MOYSKBN = QAGP.MOYSKBN AND WK01.MOYSSTDT = QAGP.MOYSSTDT AND WK01.MOYSRBAN = QAGP.MOYSRBAN AND WK01.TENGPCD = QAGP.TENGPCD LEFT OUTER JOIN INATK2.TOKTG_QASHN QASHN ON WK01.MOYSKBN = QASHN.MOYSKBN AND WK01.MOYSSTDT = QASHN.MOYSSTDT AND WK01.MOYSRBAN = QASHN.MOYSRBAN AND WK01.TENGPCD = QASHN.TENGPCD AND WK01.BMNCD = QASHN.BMNCD AND WK01.KANRINO = QASHN.KANRINO WHERE EXISTS (SELECT * FROM INAWK.ANWK_A11TC44 WK44 WHERE WK01.MOYSKBN = WK44.MOYSKBN AND WK01.MOYSSTDT = WK44.MOYSSTDT AND WK01.MOYSRBAN = WK44.MOYSRBAN AND WK44.BMNCD = WK01.BMNCD AND WK44.KANRINO = WK01.KANRINO AND WK44.KANRIENO = WK01.KANRIENO AND WK44.TENCD = WK01.TENCD)) WK08) WK08 -- TODO F X O   [ v ̏ 񂪂Ȃ  ꍇ  ܂߂邩 ǂ    ŁACOALESCE ł  肦 Ȃ    l ɕϊ    鏈       邩 ǂ    m F
WHERE COALESCE(WK08.QASYUKBN, - 1) <> 5 AND COALESCE(WK08.LTENSAIFLG, - 1) <> 2 AND COALESCE(WK08.TENSAIFLG, - 1) NOT IN (0, 3) AND COALESCE(WK08.ITMSELKBN, - 1) <> 2 AND COALESCE(WK08.TENGPCD, 0) <> 0 UNION ALL SELECT WK01.* FROM INAIF.AN_HANBAI_BFR WK01 INNER JOIN TDATE TD on WK01.QADEVSTDT > TD.DT_INT WHERE EXISTS (SELECT * FROM INAWK.ANWK_A11TC44 WK44 WHERE WK01.MOYSKBN = WK44.MOYSKBN AND WK01.MOYSSTDT = WK44.MOYSSTDT AND WK01.MOYSRBAN = WK44.MOYSRBAN AND WK44.BMNCD = WK01.BMNCD AND WK44.KANRINO = WK01.KANRINO AND WK44.KANRIENO = WK01.KANRIENO AND WK44.TENCD = WK01.TENCD);
commit;
